import{f as T,e as Y,a as u,s as A,c as fe,t as W}from"../chunks/D8_vNU_7.js";import{i as Je}from"../chunks/Skp2_pbQ.js";import{o as Ke}from"../chunks/hSDH1p8K.js";import{ab as Ye,av as ea,t as aa,Q as sa,aw as ta,af as ra,I as me,ae as ia,a2 as la,a9 as na,aa as oa,a6 as o,a8 as I,a as e,a4 as va,a5 as i,s as t,o as y,u as c,a7 as n,au as Me,ax as ca,ay as L,a3 as pe,az as da,aA as ua}from"../chunks/PIemEuav.js";import{i as x}from"../chunks/DUIRlQin.js";import{e as fa,i as ma}from"../chunks/DXx87UvT.js";import{f as G,s as pa,k as _a,m as ga,n as ba,v as ka}from"../chunks/Dmd42eFK.js";import{s as V}from"../chunks/DKJ03sjb.js";import{b as j,a as Ae,p as ha}from"../chunks/CeFRIQpE.js";import{s as qa,a as ya}from"../chunks/Dip_QOWi.js";import{b as ee}from"../chunks/DnMR8rRX.js";import{g as Le}from"../chunks/H77KXXxU.js";import{i as xa,a as wa}from"../chunks/AaN-wQOB.js";function Ce(l,g,C=!1){if(l.multiple){if(g==null)return;if(!sa(g))return ta();for(var w of l.options)w.selected=g.includes(D(w));return}for(w of l.options){var $=D(w);if(ra($,g)){w.selected=!0;return}}(!C||g!==void 0)&&(l.selectedIndex=-1)}function Ea(l){var g=new MutationObserver(()=>{Ce(l,l.__value)});g.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),aa(()=>{g.disconnect()})}function Sa(l,g,C=g){var w=new WeakSet,$=!0;Ye(l,"change",E=>{var p=E?"[selected]":":checked",k;if(l.multiple)k=[].map.call(l.querySelectorAll(p),D);else{var R=l.querySelector(p)??l.querySelector("option:not([disabled])");k=R&&D(R)}C(k),me!==null&&w.add(me)}),ea(()=>{var E=g();if(l===document.activeElement){var p=ia??me;if(w.has(p))return}if(Ce(l,E,$),$&&E===void 0){var k=l.querySelector(":checked");k!==null&&(E=D(k),C(E))}l.__value=E,$=!1}),Ea(l)}function D(l){return"__value"in l?l.__value:l.value}var Ia=T('<span class="hint svelte-kmqcod">확인 중...</span>'),Ta=T("<span> </span>"),Ma=T("<span> <!></span>"),Aa=T('<span class="hint success svelte-kmqcod">이메일 인증 완료</span>'),La=T('<span class="hint error svelte-kmqcod"> </span>'),Ca=T('<div class="field svelte-kmqcod"><label for="verificationCode" class="svelte-kmqcod">인증 코드</label> <div class="code-row svelte-kmqcod"><input type="text" id="verificationCode" placeholder="6자리 코드 입력" maxlength="6" inputmode="numeric" pattern="[0-9]*" class="svelte-kmqcod"/> <button type="button" class="verify-btn svelte-kmqcod"> </button></div> <!></div>'),$a=T("<option> </option>"),Fa=T('<div class="error-msg svelte-kmqcod"> </div>'),za=T('<div class="page svelte-kmqcod"><header class="page-header svelte-kmqcod"><h1 class="svelte-kmqcod">회원가입</h1> <p class="svelte-kmqcod">새 계정을 만드세요</p></header> <form class="form svelte-kmqcod"><div class="field svelte-kmqcod"><label for="username" class="svelte-kmqcod">아이디</label> <input type="text" id="username" placeholder="4자 이상, 영문/숫자" autocomplete="username"/> <!></div> <div class="field svelte-kmqcod"><label for="email" class="svelte-kmqcod">이메일</label> <div class="email-row svelte-kmqcod"><input type="email" id="email" placeholder="example@email.com" autocomplete="email"/> <button type="button" class="verify-btn svelte-kmqcod"><!></button></div> <!> <!></div> <!> <div class="field svelte-kmqcod"><label for="password" class="svelte-kmqcod">비밀번호</label> <input type="password" id="password" placeholder="8자 이상" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label for="passwordConfirm" class="svelte-kmqcod">비밀번호 확인</label> <input type="password" id="passwordConfirm" placeholder="비밀번호 재입력" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label class="svelte-kmqcod">성별</label> <div class="radio-group svelte-kmqcod"><label><input type="radio" class="svelte-kmqcod"/> 남성</label> <label><input type="radio" class="svelte-kmqcod"/> 여성</label></div></div> <div class="field svelte-kmqcod"><label for="ageGroup" class="svelte-kmqcod">연령대</label> <select id="ageGroup" class="svelte-kmqcod"></select></div> <!> <button type="submit" class="submit svelte-kmqcod"> </button></form> <div class="footer svelte-kmqcod"><span>이미 계정이 있으신가요?</span> <a class="svelte-kmqcod">로그인</a></div></div>');function Xa(l,g){la(g,!1);const C=()=>ya(xa,"$isLoggedIn",w),[w,$]=qa(),E=[];Ke(()=>{wa.init()});let p=y(""),k=y(""),R=y(""),S=y(""),U=y(""),F=y("MALE"),H=y("TWENTIES"),d=y({checking:!1,available:null,message:""}),a=y({sending:!1,sent:!1,verifying:!1,verified:!1,message:"",expireMinutes:null}),h=y(""),P=y(!1),_e;function $e(){if(t(d,{checking:!1,available:null,message:""}),e(p).length<4){e(p).length>0&&L(d,e(d).message="4자 이상 입력해주세요");return}clearTimeout(_e),_e=setTimeout(async()=>{L(d,e(d).checking=!0);try{const s=await _a(e(p));t(d,{checking:!1,available:s.available,message:s.available?"사용 가능":"이미 사용중"})}catch{t(d,{checking:!1,available:null,message:"확인 실패"})}},500)}function ge(s){return/^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(s)}async function Fe(){if(!ge(e(S))){L(a,e(a).message="유효한 이메일을 입력해주세요");return}L(a,e(a).sending=!0),L(a,e(a).message="");try{const s=await ga({email:e(S)});s.success?t(a,{...e(a),sending:!1,sent:!0,message:"인증 코드가 발송되었습니다",expireMinutes:s.expireMinutes}):t(a,{...e(a),sending:!1,message:s.message??"발송 실패"})}catch{t(a,{...e(a),sending:!1,message:"서버 오류"})}}async function ze(){if(e(U).length!==6){L(a,e(a).message="6자리 코드를 입력해주세요");return}L(a,e(a).verifying=!0),L(a,e(a).message="");try{const s=await ka({email:e(S),code:e(U)});s.success?t(a,{...e(a),verifying:!1,verified:!0,message:"인증 완료"}):t(a,{...e(a),verifying:!1,message:s.message??"인증 실패"})}catch{t(a,{...e(a),verifying:!1,message:"서버 오류"})}}async function Ge(){if(t(h,""),!e(p).trim()||e(p).length<4){t(h,"아이디는 4자 이상이어야 합니다");return}if(!/^[a-zA-Z0-9]+$/.test(e(p))){t(h,"아이디는 영문과 숫자만 가능합니다");return}if(!ge(e(S))){t(h,"유효한 이메일을 입력해주세요");return}if(!e(a).verified){t(h,"이메일 인증이 필요합니다");return}if(e(k).length<8){t(h,"비밀번호는 8자 이상이어야 합니다");return}if(e(k)!==e(R)){t(h,"비밀번호가 일치하지 않습니다");return}if(e(d).available===!1){t(h,"이미 사용중인 아이디입니다");return}t(P,!0);try{const s=await ba({username:e(p),password:e(k),email:e(S),gender:e(F),ageGroup:e(H)});s.success?Le(`${ee}/login?signup=success`):t(h,s.message??"가입 실패")}catch{t(h,"서버 오류가 발생했습니다")}t(P,!1)}const Re={TEENS:"10대",TWENTIES:"20대",THIRTIES:"30대",FORTIES:"40대",FIFTIES:"50대",SIXTIES_PLUS:"60대 이상"};na(()=>(C(),ee),()=>{C()&&Le(`${ee}/`)}),oa(),Je();var ae=za(),Q=i(o(ae),2),se=o(Q),Z=i(o(se),2);G(Z);let be;var Ue=i(Z,2);{var Ve=s=>{var r=Ia();u(s,r)},Ze=s=>{var r=fe(),f=pe(r);{var b=_=>{var v=Ta();let m;var q=o(v,!0);n(v),I(()=>{m=V(v,1,"hint svelte-kmqcod",null,m,{success:e(d).available,error:e(d).available===!1}),A(q,(e(d),c(()=>e(d).message)))}),u(_,v)};x(f,_=>{e(d),c(()=>e(d).message)&&_(b)},!0)}u(s,r)};x(Ue,s=>{e(d),c(()=>e(d).checking)?s(Ve):s(Ze,!1)})}n(se);var te=i(se,2),re=i(o(te),2),N=o(re);G(N);let ke;var X=i(N,2),Ne=o(X);{var Oe=s=>{var r=W("발송중...");u(s,r)},We=s=>{var r=fe(),f=pe(r);{var b=v=>{var m=W("인증완료");u(v,m)},_=v=>{var m=fe(),q=pe(m);{var z=M=>{var ue=W("재발송");u(M,ue)},O=M=>{var ue=W("인증요청");u(M,ue)};x(q,M=>{e(a),c(()=>e(a).sent)?M(z):M(O,!1)},!0)}u(v,m)};x(f,v=>{e(a),c(()=>e(a).verified)?v(b):v(_,!1)},!0)}u(s,r)};x(Ne,s=>{e(a),c(()=>e(a).sending)?s(Oe):s(We,!1)})}n(X),n(re);var he=i(re,2);{var je=s=>{var r=Ma();let f;var b=o(r),_=i(b);{var v=m=>{var q=W();I(()=>A(q,`(${e(a),c(()=>e(a).expireMinutes)??""}분 유효)`)),u(m,q)};x(_,m=>{e(a),c(()=>e(a).expireMinutes)&&m(v)})}n(r),I(()=>{f=V(r,1,"hint svelte-kmqcod",null,f,{success:e(a).sent&&!e(a).verified,error:!e(a).sent&&!e(a).verified}),A(b,`${e(a),c(()=>e(a).message)??""} `)}),u(s,r)};x(he,s=>{e(a),c(()=>e(a).message&&!e(a).verified)&&s(je)})}var De=i(he,2);{var He=s=>{var r=Aa();u(s,r)};x(De,s=>{e(a),c(()=>e(a).verified)&&s(He)})}n(te);var qe=i(te,2);{var Pe=s=>{var r=Ca(),f=i(o(r),2),b=o(f);G(b);var _=i(b,2),v=o(_,!0);n(_),n(f);var m=i(f,2);{var q=z=>{var O=La(),M=o(O,!0);n(O),I(()=>A(M,(e(a),c(()=>e(a).message)))),u(z,O)};x(m,z=>{e(a),c(()=>e(a).message&&e(a).sent&&!e(a).verified)&&z(q)})}n(r),I(()=>{_.disabled=(e(a),e(U),c(()=>e(a).verifying||e(U).length!==6)),A(v,(e(a),c(()=>e(a).verifying?"확인중...":"확인")))}),j(b,()=>e(U),z=>t(U,z)),Y("click",_,ze),u(s,r)};x(qe,s=>{e(a),c(()=>e(a).sent&&!e(a).verified)&&s(Pe)})}var ie=i(qe,2),ye=i(o(ie),2);G(ye),n(ie);var le=i(ie,2),xe=i(o(le),2);G(xe),n(le);var ne=i(le,2),we=i(o(ne),2),B=o(we);let Ee;var J=o(B);G(J),J.value=J.__value="MALE",Me(),n(B);var oe=i(B,2);let Se;var K=o(oe);G(K),K.value=K.__value="FEMALE",Me(),n(oe),n(we),n(ne);var ve=i(ne,2),ce=i(o(ve),2);I(()=>{e(H),ca(()=>{})}),fa(ce,5,()=>c(()=>Object.entries(Re)),ma,(s,r)=>{var f=da(()=>ua(e(r),2));let b=()=>e(f)[0],_=()=>e(f)[1];var v=$a(),m=o(v,!0);n(v);var q={};I(()=>{A(m,_()),q!==(q=b())&&(v.value=(v.__value=b())??"")}),u(s,v)}),n(ce),n(ve);var Ie=i(ve,2);{var Qe=s=>{var r=Fa(),f=o(r,!0);n(r),I(()=>A(f,e(h))),u(s,r)};x(Ie,s=>{e(h)&&s(Qe)})}var de=i(Ie,2),Xe=o(de,!0);n(de),n(Q);var Te=i(Q,2),Be=i(o(Te),2);n(Te),n(ae),I(()=>{be=V(Z,1,"svelte-kmqcod",null,be,{success:e(d).available===!0,error:e(d).available===!1}),N.disabled=(e(a),c(()=>e(a).verified)),ke=V(N,1,"svelte-kmqcod",null,ke,{success:e(a).verified}),X.disabled=(e(a),e(S),c(()=>e(a).sending||e(a).verified||!e(S))),Ee=V(B,1,"radio svelte-kmqcod",null,Ee,{active:e(F)==="MALE"}),Se=V(oe,1,"radio svelte-kmqcod",null,Se,{active:e(F)==="FEMALE"}),de.disabled=e(P),A(Xe,e(P)?"가입 중...":"회원가입"),pa(Be,"href",`${ee??""}/login`)}),j(Z,()=>e(p),s=>t(p,s)),Y("input",Z,$e),j(N,()=>e(S),s=>t(S,s)),Y("click",X,Fe),j(ye,()=>e(k),s=>t(k,s)),j(xe,()=>e(R),s=>t(R,s)),Ae(E,[],J,()=>e(F),s=>t(F,s)),Ae(E,[],K,()=>e(F),s=>t(F,s)),Sa(ce,()=>e(H),s=>t(H,s)),Y("submit",Q,ha(Ge)),u(l,ae),va(),$()}export{Xa as component};
