import{f as T,e as Y,a as u,s as L,c as fe,t as W}from"../chunks/B-OvIa1U.js";import{i as Je}from"../chunks/CdXFSiSg.js";import{ae as Qe,at as Ye,t as ea,T as aa,au as sa,ai as ta,K as me,ah as ra,a4 as ia,a5 as la,ac as na,ad as va,a9 as v,ab as I,a as e,a7 as oa,a8 as i,s as t,o as y,u as c,aa as n,as as Me,av as ca,aw as A,a6 as _e,ax as da,ay as ua}from"../chunks/C_qc7GMT.js";import{i as x}from"../chunks/7qhV2vbv.js";import{e as fa,i as ma}from"../chunks/voZxLLH9.js";import{i as _a,c as pa,d as z,s as ga,j as ba,k as ka,m as ha,v as qa}from"../chunks/D2PtFGOZ.js";import{s as V}from"../chunks/tHjlPVu2.js";import{b as j,a as Le,p as ya}from"../chunks/BhL1cXtI.js";import{s as xa,a as wa}from"../chunks/CqCY2mX9.js";import{b as ee}from"../chunks/rYzDofXa.js";import{g as Ae}from"../chunks/D-tmCrlR.js";function Ce(l,g,C=!1){if(l.multiple){if(g==null)return;if(!aa(g))return sa();for(var w of l.options)w.selected=g.includes(D(w));return}for(w of l.options){var $=D(w);if(ta($,g)){w.selected=!0;return}}(!C||g!==void 0)&&(l.selectedIndex=-1)}function Ea(l){var g=new MutationObserver(()=>{Ce(l,l.__value)});g.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ea(()=>{g.disconnect()})}function Sa(l,g,C=g){var w=new WeakSet,$=!0;Qe(l,"change",E=>{var _=E?"[selected]":":checked",k;if(l.multiple)k=[].map.call(l.querySelectorAll(_),D);else{var R=l.querySelector(_)??l.querySelector("option:not([disabled])");k=R&&D(R)}C(k),me!==null&&w.add(me)}),Ye(()=>{var E=g();if(l===document.activeElement){var _=ra??me;if(w.has(_))return}if(Ce(l,E,$),$&&E===void 0){var k=l.querySelector(":checked");k!==null&&(E=D(k),C(E))}l.__value=E,$=!1}),Ea(l)}function D(l){return"__value"in l?l.__value:l.value}var Ia=T('<span class="hint svelte-kmqcod">확인 중...</span>'),Ta=T("<span> </span>"),Ma=T("<span> <!></span>"),La=T('<span class="hint success svelte-kmqcod">이메일 인증 완료</span>'),Aa=T('<span class="hint error svelte-kmqcod"> </span>'),Ca=T('<div class="field svelte-kmqcod"><label for="verificationCode" class="svelte-kmqcod">인증 코드</label> <div class="code-row svelte-kmqcod"><input type="text" id="verificationCode" placeholder="6자리 코드 입력" maxlength="6" inputmode="numeric" pattern="[0-9]*" class="svelte-kmqcod"/> <button type="button" class="verify-btn svelte-kmqcod"> </button></div> <!></div>'),$a=T("<option> </option>"),Fa=T('<div class="error-msg svelte-kmqcod"> </div>'),Ga=T('<div class="page svelte-kmqcod"><header class="page-header svelte-kmqcod"><h1 class="svelte-kmqcod">회원가입</h1> <p class="svelte-kmqcod">새 계정을 만드세요</p></header> <form class="form svelte-kmqcod"><div class="field svelte-kmqcod"><label for="username" class="svelte-kmqcod">아이디</label> <input type="text" id="username" placeholder="4자 이상, 영문/숫자" autocomplete="username"/> <!></div> <div class="field svelte-kmqcod"><label for="email" class="svelte-kmqcod">이메일</label> <div class="email-row svelte-kmqcod"><input type="email" id="email" placeholder="example@email.com" autocomplete="email"/> <button type="button" class="verify-btn svelte-kmqcod"><!></button></div> <!> <!></div> <!> <div class="field svelte-kmqcod"><label for="password" class="svelte-kmqcod">비밀번호</label> <input type="password" id="password" placeholder="8자 이상" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label for="passwordConfirm" class="svelte-kmqcod">비밀번호 확인</label> <input type="password" id="passwordConfirm" placeholder="비밀번호 재입력" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label class="svelte-kmqcod">성별</label> <div class="radio-group svelte-kmqcod"><label><input type="radio" class="svelte-kmqcod"/> 남성</label> <label><input type="radio" class="svelte-kmqcod"/> 여성</label></div></div> <div class="field svelte-kmqcod"><label for="ageGroup" class="svelte-kmqcod">연령대</label> <select id="ageGroup" class="svelte-kmqcod"></select></div> <!> <button type="submit" class="submit svelte-kmqcod"> </button></form> <div class="footer svelte-kmqcod"><span>이미 계정이 있으신가요?</span> <a class="svelte-kmqcod">로그인</a></div></div>');function Ka(l,g){ia(g,!1);const C=()=>wa(_a,"$isLoggedIn",w),[w,$]=xa(),E=[];la(()=>{pa.init()});let _=y(""),k=y(""),R=y(""),S=y(""),U=y(""),F=y("MALE"),H=y("TWENTIES"),d=y({checking:!1,available:null,message:""}),a=y({sending:!1,sent:!1,verifying:!1,verified:!1,message:"",expireMinutes:null}),h=y(""),K=y(!1),pe;function $e(){if(t(d,{checking:!1,available:null,message:""}),e(_).length<4){e(_).length>0&&A(d,e(d).message="4자 이상 입력해주세요");return}clearTimeout(pe),pe=setTimeout(async()=>{A(d,e(d).checking=!0);try{const s=await ba(e(_));t(d,{checking:!1,available:s.available,message:s.available?"사용 가능":"이미 사용중"})}catch{t(d,{checking:!1,available:null,message:"확인 실패"})}},500)}function ge(s){return/^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(s)}async function Fe(){if(!ge(e(S))){A(a,e(a).message="유효한 이메일을 입력해주세요");return}A(a,e(a).sending=!0),A(a,e(a).message="");try{const s=await ka({email:e(S)});s.success?t(a,{...e(a),sending:!1,sent:!0,message:"인증 코드가 발송되었습니다",expireMinutes:s.expireMinutes}):t(a,{...e(a),sending:!1,message:s.message??"발송 실패"})}catch{t(a,{...e(a),sending:!1,message:"서버 오류"})}}async function Ge(){if(e(U).length!==6){A(a,e(a).message="6자리 코드를 입력해주세요");return}A(a,e(a).verifying=!0),A(a,e(a).message="");try{const s=await qa({email:e(S),code:e(U)});s.success?t(a,{...e(a),verifying:!1,verified:!0,message:"인증 완료"}):t(a,{...e(a),verifying:!1,message:s.message??"인증 실패"})}catch{t(a,{...e(a),verifying:!1,message:"서버 오류"})}}async function ze(){if(t(h,""),!e(_).trim()||e(_).length<4){t(h,"아이디는 4자 이상이어야 합니다");return}if(!/^[a-zA-Z0-9]+$/.test(e(_))){t(h,"아이디는 영문과 숫자만 가능합니다");return}if(!ge(e(S))){t(h,"유효한 이메일을 입력해주세요");return}if(!e(a).verified){t(h,"이메일 인증이 필요합니다");return}if(e(k).length<8){t(h,"비밀번호는 8자 이상이어야 합니다");return}if(e(k)!==e(R)){t(h,"비밀번호가 일치하지 않습니다");return}if(e(d).available===!1){t(h,"이미 사용중인 아이디입니다");return}t(K,!0);try{const s=await ha({username:e(_),password:e(k),email:e(S),gender:e(F),ageGroup:e(H)});s.success?Ae(`${ee}/login?signup=success`):t(h,s.message??"가입 실패")}catch{t(h,"서버 오류가 발생했습니다")}t(K,!1)}const Re={TEENS:"10대",TWENTIES:"20대",THIRTIES:"30대",FORTIES:"40대",FIFTIES:"50대",SIXTIES_PLUS:"60대 이상"};na(()=>(C(),ee),()=>{C()&&Ae(`${ee}/`)}),va(),Je();var ae=Ga(),P=i(v(ae),2),se=v(P),Z=i(v(se),2);z(Z);let be;var Ue=i(Z,2);{var Ve=s=>{var r=Ia();u(s,r)},Ze=s=>{var r=fe(),f=_e(r);{var b=p=>{var o=Ta();let m;var q=v(o,!0);n(o),I(()=>{m=V(o,1,"hint svelte-kmqcod",null,m,{success:e(d).available,error:e(d).available===!1}),L(q,(e(d),c(()=>e(d).message)))}),u(p,o)};x(f,p=>{e(d),c(()=>e(d).message)&&p(b)},!0)}u(s,r)};x(Ue,s=>{e(d),c(()=>e(d).checking)?s(Ve):s(Ze,!1)})}n(se);var te=i(se,2),re=i(v(te),2),N=v(re);z(N);let ke;var X=i(N,2),Ne=v(X);{var Oe=s=>{var r=W("발송중...");u(s,r)},We=s=>{var r=fe(),f=_e(r);{var b=o=>{var m=W("인증완료");u(o,m)},p=o=>{var m=fe(),q=_e(m);{var G=M=>{var ue=W("재발송");u(M,ue)},O=M=>{var ue=W("인증요청");u(M,ue)};x(q,M=>{e(a),c(()=>e(a).sent)?M(G):M(O,!1)},!0)}u(o,m)};x(f,o=>{e(a),c(()=>e(a).verified)?o(b):o(p,!1)},!0)}u(s,r)};x(Ne,s=>{e(a),c(()=>e(a).sending)?s(Oe):s(We,!1)})}n(X),n(re);var he=i(re,2);{var je=s=>{var r=Ma();let f;var b=v(r),p=i(b);{var o=m=>{var q=W();I(()=>L(q,`(${e(a),c(()=>e(a).expireMinutes)??""}분 유효)`)),u(m,q)};x(p,m=>{e(a),c(()=>e(a).expireMinutes)&&m(o)})}n(r),I(()=>{f=V(r,1,"hint svelte-kmqcod",null,f,{success:e(a).sent&&!e(a).verified,error:!e(a).sent&&!e(a).verified}),L(b,`${e(a),c(()=>e(a).message)??""} `)}),u(s,r)};x(he,s=>{e(a),c(()=>e(a).message&&!e(a).verified)&&s(je)})}var De=i(he,2);{var He=s=>{var r=La();u(s,r)};x(De,s=>{e(a),c(()=>e(a).verified)&&s(He)})}n(te);var qe=i(te,2);{var Ke=s=>{var r=Ca(),f=i(v(r),2),b=v(f);z(b);var p=i(b,2),o=v(p,!0);n(p),n(f);var m=i(f,2);{var q=G=>{var O=Aa(),M=v(O,!0);n(O),I(()=>L(M,(e(a),c(()=>e(a).message)))),u(G,O)};x(m,G=>{e(a),c(()=>e(a).message&&e(a).sent&&!e(a).verified)&&G(q)})}n(r),I(()=>{p.disabled=(e(a),e(U),c(()=>e(a).verifying||e(U).length!==6)),L(o,(e(a),c(()=>e(a).verifying?"확인중...":"확인")))}),j(b,()=>e(U),G=>t(U,G)),Y("click",p,Ge),u(s,r)};x(qe,s=>{e(a),c(()=>e(a).sent&&!e(a).verified)&&s(Ke)})}var ie=i(qe,2),ye=i(v(ie),2);z(ye),n(ie);var le=i(ie,2),xe=i(v(le),2);z(xe),n(le);var ne=i(le,2),we=i(v(ne),2),B=v(we);let Ee;var J=v(B);z(J),J.value=J.__value="MALE",Me(),n(B);var ve=i(B,2);let Se;var Q=v(ve);z(Q),Q.value=Q.__value="FEMALE",Me(),n(ve),n(we),n(ne);var oe=i(ne,2),ce=i(v(oe),2);I(()=>{e(H),ca(()=>{})}),fa(ce,5,()=>c(()=>Object.entries(Re)),ma,(s,r)=>{var f=da(()=>ua(e(r),2));let b=()=>e(f)[0],p=()=>e(f)[1];var o=$a(),m=v(o,!0);n(o);var q={};I(()=>{L(m,p()),q!==(q=b())&&(o.value=(o.__value=b())??"")}),u(s,o)}),n(ce),n(oe);var Ie=i(oe,2);{var Pe=s=>{var r=Fa(),f=v(r,!0);n(r),I(()=>L(f,e(h))),u(s,r)};x(Ie,s=>{e(h)&&s(Pe)})}var de=i(Ie,2),Xe=v(de,!0);n(de),n(P);var Te=i(P,2),Be=i(v(Te),2);n(Te),n(ae),I(()=>{be=V(Z,1,"svelte-kmqcod",null,be,{success:e(d).available===!0,error:e(d).available===!1}),N.disabled=(e(a),c(()=>e(a).verified)),ke=V(N,1,"svelte-kmqcod",null,ke,{success:e(a).verified}),X.disabled=(e(a),e(S),c(()=>e(a).sending||e(a).verified||!e(S))),Ee=V(B,1,"radio svelte-kmqcod",null,Ee,{active:e(F)==="MALE"}),Se=V(ve,1,"radio svelte-kmqcod",null,Se,{active:e(F)==="FEMALE"}),de.disabled=e(K),L(Xe,e(K)?"가입 중...":"회원가입"),ga(Be,"href",`${ee??""}/login`)}),j(Z,()=>e(_),s=>t(_,s)),Y("input",Z,$e),j(N,()=>e(S),s=>t(S,s)),Y("click",X,Fe),j(ye,()=>e(k),s=>t(k,s)),j(xe,()=>e(R),s=>t(R,s)),Le(E,[],J,()=>e(F),s=>t(F,s)),Le(E,[],Q,()=>e(F),s=>t(F,s)),Sa(ce,()=>e(H),s=>t(H,s)),Y("submit",P,ya(ze)),u(l,ae),oa(),$()}export{Ka as component};
