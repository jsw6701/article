import{f as b,a as i,t as X,c as L}from"../chunks/TFX7ugsA.js";import"../chunks/D6SK0GIy.js";import{a as Te}from"../chunks/DujhYGdh.js";import{p as ke,ao as ne,ap as De,t as A,a as Me,g as e,Y as u,e as Ze,c as r,o as t,ar as Le,s as o,b as l,f as V,at as Ve}from"../chunks/C9SIyTFa.js";import{i as _,s as C,e as q}from"../chunks/bwNj2O70.js";import{h as Be}from"../chunks/0poByBks.js";import{s as Fe,r as B,a as He}from"../chunks/xoXkTC80.js";import{b as G,p as de}from"../chunks/BMCtT5ss.js";import{i as Ye}from"../chunks/CSrNcNRV.js";import{b as fe}from"../chunks/CDBHGxnl.js";import{g as je}from"../chunks/t2ZFSGcY.js";import{y as qe,B as Ge}from"../chunks/Do2HDaJV.js";import{S as Je}from"../chunks/D-G3Vv_Y.js";var Ke=b('<div class="error-msg svelte-1wx4tso"> </div>'),Ne=b('<div class="success-msg svelte-1wx4tso"> </div>'),Oe=b('<form class="form svelte-1wx4tso"><div class="field svelte-1wx4tso"><label for="email" class="svelte-1wx4tso">이메일</label> <input type="email" id="email" placeholder="가입 시 등록한 이메일" autocomplete="email" class="svelte-1wx4tso"/></div> <!> <!> <button type="submit" class="submit svelte-1wx4tso"> </button></form>'),Qe=b('<span class="hint error svelte-1wx4tso">인증 코드가 만료되었습니다. 다시 발송해주세요.</span>'),Ue=b('<span class="hint svelte-1wx4tso">이메일로 발송된 6자리 코드를 입력하세요 <span class="timer svelte-1wx4tso"> </span></span>'),We=b('<span class="hint svelte-1wx4tso">이메일로 발송된 6자리 코드를 입력하세요</span>'),Xe=b('<div class="error-msg svelte-1wx4tso"> </div>'),$e=b('<form class="form svelte-1wx4tso"><div class="field svelte-1wx4tso"><label for="email-display" class="svelte-1wx4tso">이메일</label> <input type="email" id="email-display" disabled class="svelte-1wx4tso"/></div> <div class="field svelte-1wx4tso"><label for="code" class="svelte-1wx4tso">인증 코드</label> <input type="text" id="code" placeholder="6자리 코드" maxlength="6" inputmode="numeric" pattern="[0-9]*" autocomplete="one-time-code" class="svelte-1wx4tso"/> <!></div> <div class="field svelte-1wx4tso"><label for="newPassword" class="svelte-1wx4tso">새 비밀번호</label> <input type="password" id="newPassword" placeholder="8자 이상" autocomplete="new-password" class="svelte-1wx4tso"/></div> <div class="field svelte-1wx4tso"><label for="newPasswordConfirm" class="svelte-1wx4tso">새 비밀번호 확인</label> <input type="password" id="newPasswordConfirm" placeholder="비밀번호 재입력" autocomplete="new-password" class="svelte-1wx4tso"/></div> <!> <button type="submit" class="submit svelte-1wx4tso"> </button> <button type="button" class="secondary-btn svelte-1wx4tso"> </button></form>'),es=b('<div class="form svelte-1wx4tso"><div class="done-icon svelte-1wx4tso">✓</div> <p class="done-text svelte-1wx4tso">비밀번호가 성공적으로 변경되었습니다.<br/>새 비밀번호로 로그인해주세요.</p> <button class="submit svelte-1wx4tso">로그인하러 가기</button></div>'),ss=b('<div class="page svelte-1wx4tso"><header class="header svelte-1wx4tso"><!> <p class="subtitle svelte-1wx4tso"><!></p></header> <!> <div class="footer svelte-1wx4tso"><a class="svelte-1wx4tso">← 로그인으로 돌아가기</a></div></div>');function us(ce,me){ke(me,!1);const J=u(),k=u();let w=u("email"),P=u(""),F=u(""),D=u(""),K=u(""),g=u(!1),f=u(""),H=u(""),$=10,S=null,h=u(0);Te(()=>{S&&clearInterval(S)});function pe(s){S&&clearInterval(S),t(h,s*60),S=setInterval(()=>{Ve(h,-1),e(h)<=0&&(S&&clearInterval(S),S=null)},1e3)}function ue(s){return/^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(s)}async function ee(){if(t(f,""),t(H,""),!ue(e(P))){t(f,"유효한 이메일을 입력해주세요");return}t(g,!0);try{const s=await qe({email:e(P)});s.success?(t(H,`인증 코드가 ${e(P)}로 발송되었습니다`),$=s.expireMinutes||10,pe($),t(w,"verify")):t(f,s.message??"발송에 실패했습니다")}catch{t(f,"서버 오류가 발생했습니다")}t(g,!1)}async function _e(){if(t(f,""),e(F).length!==6){t(f,"6자리 인증 코드를 입력해주세요");return}if(e(D).length<8){t(f,"비밀번호는 8자 이상이어야 합니다");return}if(e(D)!==e(K)){t(f,"비밀번호가 일치하지 않습니다");return}t(g,!0);try{const s=await Ge({email:e(P),code:e(F),newPassword:e(D)});s.success?t(w,"done"):t(f,s.message??"비밀번호 재설정에 실패했습니다")}catch{t(f,"서버 오류가 발생했습니다")}t(g,!1)}function we(){je(`${fe}/login`)}ne(()=>e(h),()=>{t(J,e(h)>0?`${Math.floor(e(h)/60)}:${(e(h)%60).toString().padStart(2,"0")}`:"")}),ne(()=>(e(w),e(h)),()=>{t(k,e(w)==="verify"&&e(h)===0)}),De(),Ye();var N=ss();Be("1wx4tso",s=>{Ze(()=>{Le.title="비밀번호 찾기 - SHIFT"})});var O=r(N),se=r(O);Je(se,{size:"lg"});var te=o(se,2),xe=r(te);{var be=s=>{var c=X("가입한 이메일을 입력하세요");i(s,c)},ge=s=>{var c=L(),z=V(c);{var E=n=>{var d=X("인증 코드와 새 비밀번호를 입력하세요");i(n,d)},R=n=>{var d=L(),y=V(d);{var x=m=>{var a=X("비밀번호가 변경되었습니다");i(m,a)};_(y,m=>{e(w)==="done"&&m(x)},!0)}i(n,d)};_(z,n=>{e(w)==="verify"?n(E):n(R,!1)},!0)}i(s,c)};_(xe,s=>{e(w)==="email"?s(be):s(ge,!1)})}l(te),l(O);var ae=o(O,2);{var he=s=>{var c=Oe(),z=r(c),E=o(r(z),2);B(E),l(z);var R=o(z,2);{var n=a=>{var p=Ke(),M=r(p,!0);l(p),A(()=>C(M,e(f))),i(a,p)};_(R,a=>{e(f)&&a(n)})}var d=o(R,2);{var y=a=>{var p=Ne(),M=r(p,!0);l(p),A(()=>C(M,e(H))),i(a,p)};_(d,a=>{e(H)&&a(y)})}var x=o(d,2),m=r(x,!0);l(x),l(c),A(()=>{x.disabled=e(g)||!e(P),C(m,e(g)?"발송 중...":"인증 코드 받기")}),G(E,()=>e(P),a=>t(P,a)),q("submit",c,de(ee)),i(s,c)},ye=s=>{var c=L(),z=V(c);{var E=n=>{var d=$e(),y=r(d),x=o(r(y),2);B(x),l(y);var m=o(y,2),a=o(r(m),2);B(a);var p=o(a,2);{var M=v=>{var I=Qe();i(v,I)},Se=v=>{var I=L(),W=V(I);{var Ce=T=>{var Z=Ue(),ve=o(r(Z)),Re=r(ve);l(ve),l(Z),A(()=>C(Re,`(${e(J)??""})`)),i(T,Z)},Ee=T=>{var Z=We();i(T,Z)};_(W,T=>{e(J)?T(Ce):T(Ee,!1)},!0)}i(v,I)};_(p,v=>{e(k)?v(M):v(Se,!1)})}l(m);var Q=o(m,2),oe=o(r(Q),2);B(oe),l(Q);var U=o(Q,2),le=o(r(U),2);B(le),l(U);var ie=o(U,2);{var Ie=v=>{var I=Xe(),W=r(I,!0);l(I),A(()=>C(W,e(f))),i(v,I)};_(ie,v=>{e(f)&&v(Ie)})}var Y=o(ie,2),ze=r(Y,!0);l(Y);var j=o(Y,2),Ae=r(j,!0);l(j),l(d),A(()=>{He(x,e(P)),a.disabled=e(k),Y.disabled=e(g)||e(k),C(ze,e(g)?"변경 중...":"비밀번호 변경"),j.disabled=e(g),C(Ae,e(k)?"인증 코드 재발송":"다른 이메일로 다시 시도")}),G(a,()=>e(F),v=>t(F,v)),G(oe,()=>e(D),v=>t(D,v)),G(le,()=>e(K),v=>t(K,v)),q("click",j,ee),q("submit",d,de(_e)),i(n,d)},R=n=>{var d=L(),y=V(d);{var x=m=>{var a=es(),p=o(r(a),4);l(a),q("click",p,we),i(m,a)};_(y,m=>{e(w)==="done"&&m(x)},!0)}i(n,d)};_(z,n=>{e(w)==="verify"?n(E):n(R,!1)},!0)}i(s,c)};_(ae,s=>{e(w)==="email"?s(he):s(ye,!1)})}var re=o(ae,2),Pe=r(re);l(re),l(N),A(()=>Fe(Pe,"href",`${fe??""}/login`)),i(ce,N),Me()}export{us as component};
