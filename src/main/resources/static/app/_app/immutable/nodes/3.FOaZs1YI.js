import{f as y,a as u,c as Re,s as n,e as Je}from"../chunks/DeXMNu7C.js";import{i as Ke}from"../chunks/one-rmOF.js";import{N as Xe,O as Ye,W as $,Q as Ze,R as g,w as A,U as s,T as t,V as e,d as a,P as ie}from"../chunks/_mKCt0Dg.js";import{i as P}from"../chunks/n77eKvsn.js";import{e as W,i as B}from"../chunks/CfL7-1lS.js";import{i as es,b as ss,c as as,d as ts,e as vs,f as rs,h as is,j as ls,s as Ce}from"../chunks/25gMEqND.js";import{s as ds}from"../chunks/DKK5T5rF.js";import{s as D}from"../chunks/BtAqC_qU.js";import{b as le}from"../chunks/kn-GG7-K.js";import{g as ns}from"../chunks/BapkDQCs.js";var cs=y('<div class="loading svelte-1jef3w8"><div class="spinner svelte-1jef3w8"></div></div>'),os=y('<div class="error svelte-1jef3w8"><p> </p> <button class="svelte-1jef3w8">다시 시도</button></div>'),fs=y('<div class="bar-item svelte-1jef3w8"><div class="bar-wrapper svelte-1jef3w8"><div class="bar svelte-1jef3w8"></div></div> <span class="bar-label svelte-1jef3w8"> </span> <span class="bar-value svelte-1jef3w8"> </span></div>'),ps=y('<div class="bar-item svelte-1jef3w8"><div class="bar-wrapper svelte-1jef3w8"><div class="bar bar-view svelte-1jef3w8"></div></div> <span class="bar-label svelte-1jef3w8"> </span> <span class="bar-value svelte-1jef3w8"> </span></div>'),ms=y('<div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">성별 분포</h3> <div class="dist-items svelte-1jef3w8"><div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8">남성</span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar male svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div> <div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8">여성</span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar female svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div></div></div>'),ws=y('<div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8"> </span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar age svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div>'),us=y('<div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8"> </span> <div class="dist-bar-wrapper svelte-1jef3w8"><div></div></div> <span class="dist-value svelte-1jef3w8"> </span></div>'),_s=y('<section class="summary-section svelte-1jef3w8"><div class="summary-grid svelte-1jef3w8"><div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 사용자</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div> <div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 조회수</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div> <div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 카드</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div></div></section> <section class="chart-section svelte-1jef3w8"><div class="section-header svelte-1jef3w8"><h2 class="svelte-1jef3w8">일별 가입자 추이</h2> <span class="period svelte-1jef3w8"></span></div> <div class="bar-chart svelte-1jef3w8"></div></section> <section class="chart-section svelte-1jef3w8"><div class="section-header svelte-1jef3w8"><h2 class="svelte-1jef3w8">일별 조회수 추이</h2> <span class="period svelte-1jef3w8"></span></div> <div class="bar-chart svelte-1jef3w8"></div></section> <section class="distribution-section svelte-1jef3w8"><div class="dist-row svelte-1jef3w8"><!> <div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">연령대 분포</h3> <div class="dist-items svelte-1jef3w8"></div></div> <div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">회원 등급 분포</h3> <div class="dist-items svelte-1jef3w8"></div></div></div></section>',1),js=y('<div class="admin-page svelte-1jef3w8"><header class="page-header svelte-1jef3w8"><h1 class="svelte-1jef3w8">관리자 대시보드</h1> <nav class="admin-nav svelte-1jef3w8"><a class="nav-item active svelte-1jef3w8">대시보드</a> <a class="nav-item svelte-1jef3w8">유저 관리</a></nav></header> <!></div>');function Ds(De,Ge){Xe(Ge,!1);let x=A(null),I=A([]),O=A([]),_=A(null),Q=A([]),T=A([]),q=A(!0),L=A(null),de=30;Ye(()=>{const r=es.subscribe(async c=>{if(c){const G=ss.subscribe(async M=>{if(!M){ns(`${le}/`);return}await ne(),G()});r()}});return r});async function ne(){g(q,!0),g(L,null);try{const[r,c,G,M,F,S]=await Promise.all([as(),ts(de),vs(de),rs(),is(),ls()]);g(x,r),g(I,c),g(O,G),g(_,M),g(Q,F),g(T,S)}catch(r){g(L,r?.message??"데이터를 불러오는데 실패했습니다")}finally{g(q,!1)}}function j(r){return r.toLocaleString()}function R(r,c){return c===0?0:r/c*100}function U(r){return Math.max(...r.map(c=>c.count),1)}function ce(r){const c=new Date(r);return`${c.getMonth()+1}/${c.getDate()}`}Ke();var z=js(),E=s(z),oe=t(s(E),2),fe=s(oe),Me=t(fe,2);e(oe),e(E);var Ne=t(E,2);{var Ve=r=>{var c=cs();u(r,c)},Le=r=>{var c=Re(),G=ie(c);{var M=S=>{var C=os(),N=s(C),H=s(N,!0);e(N);var V=t(N,2);e(C),$(()=>n(H,a(L))),Je("click",V,ne),u(S,C)},F=S=>{var C=Re(),N=ie(C);{var H=V=>{var pe=_s(),J=ie(pe),me=s(J),K=s(me),X=t(s(K),2),Ue=s(X,!0);e(X);var we=t(X,2),ke=s(we);e(we),e(K);var Y=t(K,2),Z=t(s(Y),2),Pe=s(Z,!0);e(Z);var ue=t(Z,2),We=s(ue);e(ue),e(Y);var _e=t(Y,2),ee=t(s(_e),2),Be=s(ee,!0);e(ee);var je=t(ee,2),Ie=s(je);e(je),e(_e),e(me),e(J);var se=t(J,2),ae=s(se),Oe=t(s(ae),2);Oe.textContent="최근 30일",e(ae);var be=t(ae,2);W(be,5,()=>a(I).slice(-14),B,(o,v)=>{var l=fs(),i=s(l),f=s(i);e(i);var d=t(i,2),m=s(d,!0);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{D(f,`height: ${w??""}%`),n(m,h),n(b,a(v).count)},[()=>R(a(v).count,U(a(I))),()=>ce(a(v).date)]),u(o,l)}),e(be),e(se);var te=t(se,2),ve=s(te),Qe=t(s(ve),2);Qe.textContent="최근 30일",e(ve);var ge=t(ve,2);W(ge,5,()=>a(O).slice(-14),B,(o,v)=>{var l=ps(),i=s(l),f=s(i);e(i);var d=t(i,2),m=s(d,!0);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{D(f,`height: ${w??""}%`),n(m,h),n(b,a(v).count)},[()=>R(a(v).count,U(a(O))),()=>ce(a(v).date)]),u(o,l)}),e(ge),e(te);var he=t(te,2),ye=s(he),xe=s(ye);{var Te=o=>{var v=ms(),l=t(s(v),2),i=s(l),f=t(s(i),2),d=s(f);e(f);var m=t(f,2),p=s(m,!0);e(m),e(i);var b=t(i,2),w=t(s(b),2),h=s(w);e(w);var k=t(w,2),qe=s(k,!0);e(k),e(b),e(l),e(v),$((ze,Ee,Fe,He)=>{D(d,`width: ${ze??""}%`),n(p,Ee),D(h,`width: ${Fe??""}%`),n(qe,He)},[()=>R(a(_).male,a(_).male+a(_).female),()=>j(a(_).male),()=>R(a(_).female,a(_).male+a(_).female),()=>j(a(_).female)]),u(o,v)};P(xe,o=>{a(_)&&o(Te)})}var re=t(xe,2),Se=t(s(re),2);W(Se,5,()=>a(Q),B,(o,v)=>{var l=ws(),i=s(l),f=s(i,!0);e(i);var d=t(i,2),m=s(d);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{n(f,a(v).displayName),D(m,`width: ${w??""}%`),n(b,h)},[()=>R(a(v).count,U(a(Q))),()=>j(a(v).count)]),u(o,l)}),e(Se),e(re);var $e=t(re,2),Ae=t(s($e),2);W(Ae,5,()=>a(T),B,(o,v)=>{var l=us(),i=s(l),f=s(i,!0);e(i);var d=t(i,2),m=s(d);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h,k)=>{n(f,a(v).displayName),ds(m,1,`dist-bar grade grade-${w??""}`,"svelte-1jef3w8"),D(m,`width: ${h??""}%`),n(b,k)},[()=>a(v).grade.toLowerCase(),()=>R(a(v).count,U(a(T))),()=>j(a(v).count)]),u(o,l)}),e(Ae),e($e),e(ye),e(he),$((o,v,l,i,f,d)=>{n(Ue,o),n(ke,`오늘 +${v??""}`),n(Pe,l),n(We,`오늘 +${i??""}`),n(Be,f),n(Ie,`활성 ${d??""}`)},[()=>j(a(x).totalUsers),()=>j(a(x).todaySignups),()=>j(a(x).totalViews),()=>j(a(x).todayViews),()=>j(a(x).totalCards),()=>j(a(x).activeCards)]),u(V,pe)};P(N,V=>{a(x)&&V(H)},!0)}u(S,C)};P(G,S=>{a(L)?S(M):S(F,!1)},!0)}u(r,c)};P(Ne,r=>{a(q)?r(Ve):r(Le,!1)})}e(z),$(()=>{Ce(fe,"href",`${le??""}/admin`),Ce(Me,"href",`${le??""}/admin/users`)}),u(De,z),Ze()}export{Ds as component};
