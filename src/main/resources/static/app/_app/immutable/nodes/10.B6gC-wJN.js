import{f as y,a as d,c as ae,t as F}from"../chunks/CSDkEukK.js";import"../chunks/G9K82XB2.js";import{o as We}from"../chunks/D2Z1D5OA.js";import{p as Be,aq as Pe,ar as Xe,t as x,g as e,a as Ye,e as je,c as o,s as i,o as l,Y as _,ap as Je,ao as Ke,b as r,u as c,as as q,f as se}from"../chunks/TeviCJ82.js";import{e as E,s as w}from"../chunks/DJUeCBpJ.js";import{i as b}from"../chunks/iMg5e8oI.js";import{e as Qe,i as ea}from"../chunks/CqNPvWgI.js";import{h as aa}from"../chunks/DBo6aLs-.js";import{r as z,s as sa}from"../chunks/B9lDzZO_.js";import{s as S}from"../chunks/C9eT_MQU.js";import{b as R,p as ta}from"../chunks/DLP64Ruc.js";import{i as la}from"../chunks/DgK7GOei.js";import{s as ia,a as ra}from"../chunks/CmgmZfZy.js";import{b as G}from"../chunks/6qb4cKv1.js";import{g as ke}from"../chunks/juZnnKQr.js";import{i as oa,y as na,B as va,C as ca,D as da,E as ma}from"../chunks/C8ccASB2.js";import{S as ua}from"../chunks/BQn88HLH.js";var fa=y('<span class="hint svelte-kmqcod">확인 중...</span>'),pa=y("<span> </span>"),ga=y("<span> <!></span>"),_a=y('<span class="hint success svelte-kmqcod">이메일 인증 완료</span>'),ba=y('<div class="field svelte-kmqcod"><label for="verificationCode" class="svelte-kmqcod">인증 코드</label> <div class="input-row svelte-kmqcod"><input type="text" id="verificationCode" placeholder="6자리 코드" maxlength="6" inputmode="numeric" pattern="[0-9]*" class="svelte-kmqcod"/> <button type="button" class="inline-btn svelte-kmqcod"> </button></div></div>'),ka=y('<button type="button"> </button>'),ha=y('<div class="error-msg svelte-kmqcod"> </div>'),qa=y('<div class="page svelte-kmqcod"><header class="header svelte-kmqcod"><!> <p class="subtitle svelte-kmqcod">새 계정을 만드세요</p></header> <form class="form svelte-kmqcod"><div class="field svelte-kmqcod"><label for="username" class="svelte-kmqcod">아이디</label> <input type="text" id="username" placeholder="4자 이상, 영문/숫자" autocomplete="username"/> <!></div> <div class="field svelte-kmqcod"><label for="email" class="svelte-kmqcod">이메일</label> <div class="input-row svelte-kmqcod"><input type="email" id="email" placeholder="example@email.com" autocomplete="email"/> <button type="button" class="inline-btn svelte-kmqcod"><!></button></div> <!> <!></div> <!> <div class="field svelte-kmqcod"><label for="password" class="svelte-kmqcod">비밀번호</label> <input type="password" id="password" placeholder="8자 이상" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label for="passwordConfirm" class="svelte-kmqcod">비밀번호 확인</label> <input type="password" id="passwordConfirm" placeholder="비밀번호 재입력" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label class="svelte-kmqcod">성별</label> <div class="segment-control svelte-kmqcod"><button type="button">남성</button> <button type="button">여성</button></div></div> <div class="field svelte-kmqcod"><label class="svelte-kmqcod">연령대</label> <div class="segment-control wide svelte-kmqcod"></div></div> <!> <button type="submit" class="submit svelte-kmqcod"> </button></form> <div class="footer svelte-kmqcod"><span>이미 계정이 있으신가요?</span> <a class="svelte-kmqcod">로그인</a></div></div>');function Za(he,qe){Be(qe,!1);const te=()=>ra(oa,"$isLoggedIn",ye),[ye,xe]=ia();We(()=>{na.init()});let k=_(""),L=_(""),N=_(""),h=_(""),I=_(""),A=_("MALE"),D=_("TWENTIES"),n=_({checking:!1,available:null,message:""}),a=_({sending:!1,sent:!1,verifying:!1,verified:!1,message:"",expireMinutes:null}),g=_(""),U=_(!1),le;function Ee(){if(l(n,{checking:!1,available:null,message:""}),e(k).length<4){e(k).length>0&&q(n,e(n).message="4자 이상 입력해주세요");return}clearTimeout(le),le=setTimeout(async()=>{q(n,e(n).checking=!0);try{const s=await va(e(k));l(n,{checking:!1,available:s.available,message:s.available?"사용 가능":"이미 사용중"})}catch{l(n,{checking:!1,available:null,message:"확인 실패"})}},500)}function ie(s){return/^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(s)}async function we(){if(!ie(e(h))){q(a,e(a).message="유효한 이메일을 입력해주세요");return}q(a,e(a).sending=!0),q(a,e(a).message="");try{const s=await ca({email:e(h)});s.success?l(a,{...e(a),sending:!1,sent:!0,message:"인증 코드가 발송되었습니다",expireMinutes:s.expireMinutes}):l(a,{...e(a),sending:!1,message:s.message??"발송 실패"})}catch{l(a,{...e(a),sending:!1,message:"서버 오류"})}}async function Se(){if(e(I).length!==6){q(a,e(a).message="6자리 코드를 입력해주세요");return}q(a,e(a).verifying=!0),q(a,e(a).message="");try{const s=await ma({email:e(h),code:e(I)});s.success?l(a,{...e(a),verifying:!1,verified:!0,message:"인증 완료"}):l(a,{...e(a),verifying:!1,message:s.message??"인증 실패"})}catch{l(a,{...e(a),verifying:!1,message:"서버 오류"})}}async function Ie(){if(l(g,""),!e(k).trim()||e(k).length<4){l(g,"아이디는 4자 이상이어야 합니다");return}if(!/^[a-zA-Z0-9]+$/.test(e(k))){l(g,"아이디는 영문과 숫자만 가능합니다");return}if(!ie(e(h))){l(g,"유효한 이메일을 입력해주세요");return}if(!e(a).verified){l(g,"이메일 인증이 필요합니다");return}if(e(L).length<8){l(g,"비밀번호는 8자 이상이어야 합니다");return}if(e(L)!==e(N)){l(g,"비밀번호가 일치하지 않습니다");return}if(e(n).available===!1){l(g,"이미 사용중인 아이디입니다");return}l(U,!0);try{const s=await da({username:e(k),password:e(L),email:e(h),gender:e(A),ageGroup:e(D)});s.success?ke(`${G}/login?signup=success`):l(g,s.message??"가입 실패")}catch{l(g,"서버 오류가 발생했습니다")}l(U,!1)}const Te=[{value:"TEENS",label:"10대"},{value:"TWENTIES",label:"20대"},{value:"THIRTIES",label:"30대"},{value:"FORTIES",label:"40대"},{value:"FIFTIES",label:"50대"},{value:"SIXTIES_PLUS",label:"60대+"}];Pe(()=>(te(),G),()=>{te()&&ke(`${G}/`)}),Xe(),la();var H=qa();aa("kmqcod",s=>{je(()=>{Je.title="회원가입 - SHIFT"})});var O=o(H),Me=o(O);ua(Me,{size:"lg"}),Ke(2),r(O);var V=i(O,2),W=o(V),C=i(o(W),2);z(C);let re;var Le=i(C,2);{var Ae=s=>{var t=fa();d(s,t)},Ce=s=>{var t=ae(),v=se(t);{var f=u=>{var m=pa();let p;var T=o(m,!0);r(m),x(()=>{p=S(m,1,"hint svelte-kmqcod",null,p,{success:e(n).available,error:e(n).available===!1}),w(T,(e(n),c(()=>e(n).message)))}),d(u,m)};b(v,u=>{e(n),c(()=>e(n).message)&&u(f)},!0)}d(s,t)};b(Le,s=>{e(n),c(()=>e(n).checking)?s(Ae):s(Ce,!1)})}r(W);var B=i(W,2),P=i(o(B),2),$=o(P);z($);let oe;var Z=i($,2),$e=o(Z);{var Fe=s=>{var t=F("발송중");d(s,t)},ze=s=>{var t=ae(),v=se(t);{var f=m=>{var p=F("완료");d(m,p)},u=m=>{var p=ae(),T=se(p);{var He=M=>{var ee=F("재발송");d(M,ee)},Oe=M=>{var ee=F("인증");d(M,ee)};b(T,M=>{e(a),c(()=>e(a).sent)?M(He):M(Oe,!1)},!0)}d(m,p)};b(v,m=>{e(a),c(()=>e(a).verified)?m(f):m(u,!1)},!0)}d(s,t)};b($e,s=>{e(a),c(()=>e(a).sending)?s(Fe):s(ze,!1)})}r(Z),r(P);var ne=i(P,2);{var Re=s=>{var t=ga();let v;var f=o(t),u=i(f);{var m=p=>{var T=F();x(()=>w(T,`(${e(a),c(()=>e(a).expireMinutes)??""}분 유효)`)),d(p,T)};b(u,p=>{e(a),c(()=>e(a).expireMinutes)&&p(m)})}r(t),x(()=>{v=S(t,1,"hint svelte-kmqcod",null,v,{success:e(a).sent,error:!e(a).sent}),w(f,`${e(a),c(()=>e(a).message)??""} `)}),d(s,t)};b(ne,s=>{e(a),c(()=>e(a).message&&!e(a).verified)&&s(Re)})}var Ue=i(ne,2);{var Ve=s=>{var t=_a();d(s,t)};b(Ue,s=>{e(a),c(()=>e(a).verified)&&s(Ve)})}r(B);var ve=i(B,2);{var Ze=s=>{var t=ba(),v=i(o(t),2),f=o(v);z(f);var u=i(f,2),m=o(u,!0);r(u),r(v),r(t),x(()=>{u.disabled=(e(a),e(I),c(()=>e(a).verifying||e(I).length!==6)),w(m,(e(a),c(()=>e(a).verifying?"확인중":"확인")))}),R(f,()=>e(I),p=>l(I,p)),E("click",u,Se),d(s,t)};b(ve,s=>{e(a),c(()=>e(a).sent&&!e(a).verified)&&s(Ze)})}var X=i(ve,2),ce=i(o(X),2);z(ce),r(X);var Y=i(X,2),de=i(o(Y),2);z(de),r(Y);var j=i(Y,2),me=i(o(j),2),J=o(me);let ue;var fe=i(J,2);let pe;r(me),r(j);var K=i(j,2),ge=i(o(K),2);Qe(ge,5,()=>Te,ea,(s,t)=>{var v=ka();let f;var u=o(v,!0);r(v),x(()=>{f=S(v,1,"segment svelte-kmqcod",null,f,{active:e(D)===e(t).value}),w(u,(e(t),c(()=>e(t).label)))}),E("click",v,()=>l(D,e(t).value)),d(s,v)}),r(ge),r(K);var _e=i(K,2);{var Ge=s=>{var t=ha(),v=o(t,!0);r(t),x(()=>w(v,e(g))),d(s,t)};b(_e,s=>{e(g)&&s(Ge)})}var Q=i(_e,2),Ne=o(Q,!0);r(Q),r(V);var be=i(V,2),De=i(o(be),2);r(be),r(H),x(()=>{re=S(C,1,"svelte-kmqcod",null,re,{success:e(n).available===!0,error:e(n).available===!1}),$.disabled=(e(a),c(()=>e(a).verified)),oe=S($,1,"svelte-kmqcod",null,oe,{success:e(a).verified}),Z.disabled=(e(a),e(h),c(()=>e(a).sending||e(a).verified||!e(h))),ue=S(J,1,"segment svelte-kmqcod",null,ue,{active:e(A)==="MALE"}),pe=S(fe,1,"segment svelte-kmqcod",null,pe,{active:e(A)==="FEMALE"}),Q.disabled=e(U),w(Ne,e(U)?"가입 중...":"회원가입"),sa(De,"href",`${G??""}/login`)}),R(C,()=>e(k),s=>l(k,s)),E("input",C,Ee),R($,()=>e(h),s=>l(h,s)),E("click",Z,we),R(ce,()=>e(L),s=>l(L,s)),R(de,()=>e(N),s=>l(N,s)),E("click",J,()=>l(A,"MALE")),E("click",fe,()=>l(A,"FEMALE")),E("submit",V,ta(Ie)),d(he,H),Ye(),xe()}export{Za as component};
