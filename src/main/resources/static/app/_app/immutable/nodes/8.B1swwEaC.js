import{f as T,e as Y,a as u,s as M,c as me,t as W}from"../chunks/DeXMNu7C.js";import{i as Ye}from"../chunks/one-rmOF.js";import{$ as ea,e as aa,a1 as sa,y as ta,av as ra,a3 as ia,o as _e,a2 as la,N as na,O as va,Z as oa,_ as da,U as v,W as I,d as e,Q as ca,T as i,R as t,w as y,X as pe,V as n,u as d,aw as ua,ax as A,P as ge,ay as fa,az as ma}from"../chunks/_mKCt0Dg.js";import{i as x}from"../chunks/n77eKvsn.js";import{e as _a,i as pa}from"../chunks/CfL7-1lS.js";import{i as ga,p as ba,q as G,s as ka,z as ha,A as qa,B as ya,C as xa}from"../chunks/25gMEqND.js";import{s as V}from"../chunks/DKK5T5rF.js";import{b as P,a as Ae,p as wa}from"../chunks/BvDqwZjj.js";import{s as Ea,a as Sa}from"../chunks/DDnpUyjA.js";import{b as ee}from"../chunks/kn-GG7-K.js";import{g as Ce}from"../chunks/BapkDQCs.js";import{S as Ia}from"../chunks/CsIKBILP.js";function $e(l,g,C=!1){if(l.multiple){if(g==null)return;if(!ta(g))return ra();for(var w of l.options)w.selected=g.includes(X(w));return}for(w of l.options){var $=X(w);if(ia($,g)){w.selected=!0;return}}(!C||g!==void 0)&&(l.selectedIndex=-1)}function Ta(l){var g=new MutationObserver(()=>{$e(l,l.__value)});g.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),sa(()=>{g.disconnect()})}function La(l,g,C=g){var w=new WeakSet,$=!0;ea(l,"change",E=>{var _=E?"[selected]":":checked",k;if(l.multiple)k=[].map.call(l.querySelectorAll(_),X);else{var R=l.querySelector(_)??l.querySelector("option:not([disabled])");k=R&&X(R)}C(k),_e!==null&&w.add(_e)}),aa(()=>{var E=g();if(l===document.activeElement){var _=la??_e;if(w.has(_))return}if($e(l,E,$),$&&E===void 0){var k=l.querySelector(":checked");k!==null&&(E=X(k),C(E))}l.__value=E,$=!1}),Ta(l)}function X(l){return"__value"in l?l.__value:l.value}var Ma=T('<span class="hint svelte-kmqcod">확인 중...</span>'),Aa=T("<span> </span>"),Ca=T("<span> <!></span>"),$a=T('<span class="hint success svelte-kmqcod">이메일 인증 완료</span>'),za=T('<span class="hint error svelte-kmqcod"> </span>'),Fa=T('<div class="field svelte-kmqcod"><label for="verificationCode" class="svelte-kmqcod">인증 코드</label> <div class="code-row svelte-kmqcod"><input type="text" id="verificationCode" placeholder="6자리 코드 입력" maxlength="6" inputmode="numeric" pattern="[0-9]*" class="svelte-kmqcod"/> <button type="button" class="verify-btn svelte-kmqcod"> </button></div> <!></div>'),Ga=T("<option> </option>"),Ra=T('<div class="error-msg svelte-kmqcod"> </div>'),Ua=T('<div class="page svelte-kmqcod"><header class="page-header svelte-kmqcod"><!> <p class="svelte-kmqcod">새 계정을 만드세요</p></header> <form class="form svelte-kmqcod"><div class="field svelte-kmqcod"><label for="username" class="svelte-kmqcod">아이디</label> <input type="text" id="username" placeholder="4자 이상, 영문/숫자" autocomplete="username"/> <!></div> <div class="field svelte-kmqcod"><label for="email" class="svelte-kmqcod">이메일</label> <div class="email-row svelte-kmqcod"><input type="email" id="email" placeholder="example@email.com" autocomplete="email"/> <button type="button" class="verify-btn svelte-kmqcod"><!></button></div> <!> <!></div> <!> <div class="field svelte-kmqcod"><label for="password" class="svelte-kmqcod">비밀번호</label> <input type="password" id="password" placeholder="8자 이상" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label for="passwordConfirm" class="svelte-kmqcod">비밀번호 확인</label> <input type="password" id="passwordConfirm" placeholder="비밀번호 재입력" autocomplete="new-password" class="svelte-kmqcod"/></div> <div class="field svelte-kmqcod"><label class="svelte-kmqcod">성별</label> <div class="radio-group svelte-kmqcod"><label><input type="radio" class="svelte-kmqcod"/> 남성</label> <label><input type="radio" class="svelte-kmqcod"/> 여성</label></div></div> <div class="field svelte-kmqcod"><label for="ageGroup" class="svelte-kmqcod">연령대</label> <select id="ageGroup" class="svelte-kmqcod"></select></div> <!> <button type="submit" class="submit svelte-kmqcod"> </button></form> <div class="footer svelte-kmqcod"><span>이미 계정이 있으신가요?</span> <a class="svelte-kmqcod">로그인</a></div></div>');function Ja(l,g){na(g,!1);const C=()=>Sa(ga,"$isLoggedIn",w),[w,$]=Ea(),E=[];va(()=>{ba.init()});let _=y(""),k=y(""),R=y(""),S=y(""),U=y(""),z=y("MALE"),j=y("TWENTIES"),c=y({checking:!1,available:null,message:""}),a=y({sending:!1,sent:!1,verifying:!1,verified:!1,message:"",expireMinutes:null}),h=y(""),B=y(!1),be;function ze(){if(t(c,{checking:!1,available:null,message:""}),e(_).length<4){e(_).length>0&&A(c,e(c).message="4자 이상 입력해주세요");return}clearTimeout(be),be=setTimeout(async()=>{A(c,e(c).checking=!0);try{const s=await ha(e(_));t(c,{checking:!1,available:s.available,message:s.available?"사용 가능":"이미 사용중"})}catch{t(c,{checking:!1,available:null,message:"확인 실패"})}},500)}function ke(s){return/^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(s)}async function Fe(){if(!ke(e(S))){A(a,e(a).message="유효한 이메일을 입력해주세요");return}A(a,e(a).sending=!0),A(a,e(a).message="");try{const s=await qa({email:e(S)});s.success?t(a,{...e(a),sending:!1,sent:!0,message:"인증 코드가 발송되었습니다",expireMinutes:s.expireMinutes}):t(a,{...e(a),sending:!1,message:s.message??"발송 실패"})}catch{t(a,{...e(a),sending:!1,message:"서버 오류"})}}async function Ge(){if(e(U).length!==6){A(a,e(a).message="6자리 코드를 입력해주세요");return}A(a,e(a).verifying=!0),A(a,e(a).message="");try{const s=await xa({email:e(S),code:e(U)});s.success?t(a,{...e(a),verifying:!1,verified:!0,message:"인증 완료"}):t(a,{...e(a),verifying:!1,message:s.message??"인증 실패"})}catch{t(a,{...e(a),verifying:!1,message:"서버 오류"})}}async function Re(){if(t(h,""),!e(_).trim()||e(_).length<4){t(h,"아이디는 4자 이상이어야 합니다");return}if(!/^[a-zA-Z0-9]+$/.test(e(_))){t(h,"아이디는 영문과 숫자만 가능합니다");return}if(!ke(e(S))){t(h,"유효한 이메일을 입력해주세요");return}if(!e(a).verified){t(h,"이메일 인증이 필요합니다");return}if(e(k).length<8){t(h,"비밀번호는 8자 이상이어야 합니다");return}if(e(k)!==e(R)){t(h,"비밀번호가 일치하지 않습니다");return}if(e(c).available===!1){t(h,"이미 사용중인 아이디입니다");return}t(B,!0);try{const s=await ya({username:e(_),password:e(k),email:e(S),gender:e(z),ageGroup:e(j)});s.success?Ce(`${ee}/login?signup=success`):t(h,s.message??"가입 실패")}catch{t(h,"서버 오류가 발생했습니다")}t(B,!1)}const Ue={TEENS:"10대",TWENTIES:"20대",THIRTIES:"30대",FORTIES:"40대",FIFTIES:"50대",SIXTIES_PLUS:"60대 이상"};oa(()=>(C(),ee),()=>{C()&&Ce(`${ee}/`)}),da(),Ye();var ae=Ua(),se=v(ae),Ve=v(se);Ia(Ve,{size:"lg"}),pe(2),n(se);var D=i(se,2),te=v(D),Z=i(v(te),2);G(Z);let he;var Ze=i(Z,2);{var Ne=s=>{var r=Ma();u(s,r)},Oe=s=>{var r=me(),f=ge(r);{var b=p=>{var o=Aa();let m;var q=v(o,!0);n(o),I(()=>{m=V(o,1,"hint svelte-kmqcod",null,m,{success:e(c).available,error:e(c).available===!1}),M(q,(e(c),d(()=>e(c).message)))}),u(p,o)};x(f,p=>{e(c),d(()=>e(c).message)&&p(b)},!0)}u(s,r)};x(Ze,s=>{e(c),d(()=>e(c).checking)?s(Ne):s(Oe,!1)})}n(te);var re=i(te,2),ie=i(v(re),2),N=v(ie);G(N);let qe;var H=i(N,2),We=v(H);{var Pe=s=>{var r=W("발송중...");u(s,r)},Xe=s=>{var r=me(),f=ge(r);{var b=o=>{var m=W("인증완료");u(o,m)},p=o=>{var m=me(),q=ge(m);{var F=L=>{var fe=W("재발송");u(L,fe)},O=L=>{var fe=W("인증요청");u(L,fe)};x(q,L=>{e(a),d(()=>e(a).sent)?L(F):L(O,!1)},!0)}u(o,m)};x(f,o=>{e(a),d(()=>e(a).verified)?o(b):o(p,!1)},!0)}u(s,r)};x(We,s=>{e(a),d(()=>e(a).sending)?s(Pe):s(Xe,!1)})}n(H),n(ie);var ye=i(ie,2);{var je=s=>{var r=Ca();let f;var b=v(r),p=i(b);{var o=m=>{var q=W();I(()=>M(q,`(${e(a),d(()=>e(a).expireMinutes)??""}분 유효)`)),u(m,q)};x(p,m=>{e(a),d(()=>e(a).expireMinutes)&&m(o)})}n(r),I(()=>{f=V(r,1,"hint svelte-kmqcod",null,f,{success:e(a).sent&&!e(a).verified,error:!e(a).sent&&!e(a).verified}),M(b,`${e(a),d(()=>e(a).message)??""} `)}),u(s,r)};x(ye,s=>{e(a),d(()=>e(a).message&&!e(a).verified)&&s(je)})}var Be=i(ye,2);{var De=s=>{var r=$a();u(s,r)};x(Be,s=>{e(a),d(()=>e(a).verified)&&s(De)})}n(re);var xe=i(re,2);{var He=s=>{var r=Fa(),f=i(v(r),2),b=v(f);G(b);var p=i(b,2),o=v(p,!0);n(p),n(f);var m=i(f,2);{var q=F=>{var O=za(),L=v(O,!0);n(O),I(()=>M(L,(e(a),d(()=>e(a).message)))),u(F,O)};x(m,F=>{e(a),d(()=>e(a).message&&e(a).sent&&!e(a).verified)&&F(q)})}n(r),I(()=>{p.disabled=(e(a),e(U),d(()=>e(a).verifying||e(U).length!==6)),M(o,(e(a),d(()=>e(a).verifying?"확인중...":"확인")))}),P(b,()=>e(U),F=>t(U,F)),Y("click",p,Ge),u(s,r)};x(xe,s=>{e(a),d(()=>e(a).sent&&!e(a).verified)&&s(He)})}var le=i(xe,2),we=i(v(le),2);G(we),n(le);var ne=i(le,2),Ee=i(v(ne),2);G(Ee),n(ne);var ve=i(ne,2),Se=i(v(ve),2),Q=v(Se);let Ie;var J=v(Q);G(J),J.value=J.__value="MALE",pe(),n(Q);var oe=i(Q,2);let Te;var K=v(oe);G(K),K.value=K.__value="FEMALE",pe(),n(oe),n(Se),n(ve);var de=i(ve,2),ce=i(v(de),2);I(()=>{e(j),ua(()=>{})}),_a(ce,5,()=>d(()=>Object.entries(Ue)),pa,(s,r)=>{var f=fa(()=>ma(e(r),2));let b=()=>e(f)[0],p=()=>e(f)[1];var o=Ga(),m=v(o,!0);n(o);var q={};I(()=>{M(m,p()),q!==(q=b())&&(o.value=(o.__value=b())??"")}),u(s,o)}),n(ce),n(de);var Le=i(de,2);{var Qe=s=>{var r=Ra(),f=v(r,!0);n(r),I(()=>M(f,e(h))),u(s,r)};x(Le,s=>{e(h)&&s(Qe)})}var ue=i(Le,2),Je=v(ue,!0);n(ue),n(D);var Me=i(D,2),Ke=i(v(Me),2);n(Me),n(ae),I(()=>{he=V(Z,1,"svelte-kmqcod",null,he,{success:e(c).available===!0,error:e(c).available===!1}),N.disabled=(e(a),d(()=>e(a).verified)),qe=V(N,1,"svelte-kmqcod",null,qe,{success:e(a).verified}),H.disabled=(e(a),e(S),d(()=>e(a).sending||e(a).verified||!e(S))),Ie=V(Q,1,"radio svelte-kmqcod",null,Ie,{active:e(z)==="MALE"}),Te=V(oe,1,"radio svelte-kmqcod",null,Te,{active:e(z)==="FEMALE"}),ue.disabled=e(B),M(Je,e(B)?"가입 중...":"회원가입"),ka(Ke,"href",`${ee??""}/login`)}),P(Z,()=>e(_),s=>t(_,s)),Y("input",Z,ze),P(N,()=>e(S),s=>t(S,s)),Y("click",H,Fe),P(we,()=>e(k),s=>t(k,s)),P(Ee,()=>e(R),s=>t(R,s)),Ae(E,[],J,()=>e(z),s=>t(z,s)),Ae(E,[],K,()=>e(z),s=>t(z,s)),La(ce,()=>e(j),s=>t(j,s)),Y("submit",D,wa(Re)),u(l,ae),ca(),$()}export{Ja as component};
