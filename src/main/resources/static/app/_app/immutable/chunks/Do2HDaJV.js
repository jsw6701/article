var S;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(S||(S={}));class x extends Error{constructor(t,n,s){super(t),this.message=t,this.code=n,this.data=s}}const Q=e=>{var t,n;return e?.androidBridge?"android":!((n=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Y=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},s=n.Plugins=n.Plugins||{},r=()=>t!==null?t.name:Q(e),i=()=>r()!=="web",d=c=>{const l=h.get(c);return!!(l?.platforms.has(r())||o(c))},o=c=>{var l;return(l=n.PluginHeaders)===null||l===void 0?void 0:l.find(A=>A.name===c)},u=c=>e.console.error(c),h=new Map,T=(c,l={})=>{const A=h.get(c);if(A)return console.warn(`Capacitor plugin "${c}" already registered. Cannot register plugins twice.`),A.proxy;const E=r(),P=o(c);let w;const V=async()=>(!w&&E in l?w=typeof l[E]=="function"?w=await l[E]():w=l[E]:t!==null&&!w&&"web"in l&&(w=typeof l.web=="function"?w=await l.web():w=l.web),w),q=(f,p)=>{var m,b;if(P){const v=P?.methods.find(g=>p===g.name);if(v)return v.rtype==="promise"?g=>n.nativePromise(c,p.toString(),g):(g,L)=>n.nativeCallback(c,p.toString(),g,L);if(f)return(m=f[p])===null||m===void 0?void 0:m.bind(f)}else{if(f)return(b=f[p])===null||b===void 0?void 0:b.bind(f);throw new x(`"${c}" plugin is not implemented on ${E}`,S.Unimplemented)}},U=f=>{let p;const m=(...b)=>{const v=V().then(g=>{const L=q(g,f);if(L){const R=L(...b);return p=R?.remove,R}else throw new x(`"${c}.${f}()" is not implemented on ${E}`,S.Unimplemented)});return f==="addListener"&&(v.remove=async()=>p()),v};return m.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(m,"name",{value:f,writable:!1,configurable:!1}),m},D=U("addListener"),I=U("removeListener"),z=(f,p)=>{const m=D({eventName:f},p),b=async()=>{const g=await m;I({eventName:f,callbackId:g},p)},v=new Promise(g=>m.then(()=>g({remove:b})));return v.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await b()},v},$=new Proxy({},{get(f,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return P?z:D;case"removeListener":return I;default:return U(p)}}});return s[c]=$,h.set(c,{name:c,proxy:$,platforms:new Set([...Object.keys(l),...P?[E]:[]])}),$};return n.convertFileSrc||(n.convertFileSrc=c=>c),n.getPlatform=r,n.handleError=u,n.isNativePlatform=i,n.isPluginAvailable=d,n.registerPlugin=T,n.Exception=x,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},X=e=>e.Capacitor=Y(e),j=X(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),_=j.registerPlugin;class N{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,n){let s=!1;this.listeners[t]||(this.listeners[t]=[],s=!0),this.listeners[t].push(n);const i=this.windowListeners[t];i&&!i.registered&&this.addWindowListener(i),s&&this.sendRetainedArgumentsForEvent(t);const d=async()=>this.removeListener(t,n);return Promise.resolve({remove:d})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,n,s){const r=this.listeners[t];if(!r){if(s){let i=this.retainedEventArguments[t];i||(i=[]),i.push(n),this.retainedEventArguments[t]=i}return}r.forEach(i=>i(n))}hasListeners(t){var n;return!!(!((n=this.listeners[t])===null||n===void 0)&&n.length)}registerWindowListener(t,n){this.windowListeners[n]={registered:!1,windowEventName:t,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(t="not implemented"){return new j.Exception(t,S.Unimplemented)}unavailable(t="not available"){return new j.Exception(t,S.Unavailable)}async removeListener(t,n){const s=this.listeners[t];if(!s)return;const r=s.indexOf(n);this.listeners[t].splice(r,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const n=this.retainedEventArguments[t];n&&(delete this.retainedEventArguments[t],n.forEach(s=>{this.notifyListeners(t,s)}))}}const B=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),H=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Z extends N{async getCookies(){const t=document.cookie,n={};return t.split(";").forEach(s=>{if(s.length<=0)return;let[r,i]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=H(r).trim(),i=H(i).trim(),n[r]=i}),n}async setCookie(t){try{const n=B(t.key),s=B(t.value),r=`; expires=${(t.expires||"").replace("expires=","")}`,i=(t.path||"/").replace("path=",""),d=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${n}=${s||""}${r}; path=${i}; ${d};`}catch(n){return Promise.reject(n)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const n of t)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}_("CapacitorCookies",{web:()=>new Z});const ee=async e=>new Promise((t,n)=>{const s=new FileReader;s.onload=()=>{const r=s.result;t(r.indexOf(",")>=0?r.split(",")[1]:r)},s.onerror=r=>n(r),s.readAsDataURL(e)}),te=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(r=>r.toLocaleLowerCase()).reduce((r,i,d)=>(r[i]=e[t[d]],r),{})},ne=(e,t=!0)=>e?Object.entries(e).reduce((s,r)=>{const[i,d]=r;let o,u;return Array.isArray(d)?(u="",d.forEach(h=>{o=t?encodeURIComponent(h):h,u+=`${i}=${o}&`}),u.slice(0,-1)):(o=t?encodeURIComponent(d):d,u=`${i}=${o}`),`${s}&${u}`},"").substr(1):null,re=(e,t={})=>{const n=Object.assign({method:e.method||"GET",headers:e.headers},t),r=te(e.headers)["content-type"]||"";if(typeof e.data=="string")n.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[d,o]of Object.entries(e.data||{}))i.set(d,o);n.body=i.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){const i=new FormData;if(e.data instanceof FormData)e.data.forEach((o,u)=>{i.append(u,o)});else for(const o of Object.keys(e.data))i.append(o,e.data[o]);n.body=i;const d=new Headers(n.headers);d.delete("content-type"),n.headers=d}else(r.includes("application/json")||typeof e.data=="object")&&(n.body=JSON.stringify(e.data));return n};class se extends N{async request(t){const n=re(t,t.webFetchExtra),s=ne(t.params,t.shouldEncodeUrlParams),r=s?`${t.url}?${s}`:t.url,i=await fetch(r,n),d=i.headers.get("content-type")||"";let{responseType:o="text"}=i.ok?t:{};d.includes("application/json")&&(o="json");let u,h;switch(o){case"arraybuffer":case"blob":h=await i.blob(),u=await ee(h);break;case"json":u=await i.json();break;default:u=await i.text()}const T={};return i.headers.forEach((c,l)=>{T[l]=c}),{data:u,headers:T,status:i.status,url:i.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}_("CapacitorHttp",{web:()=>new se});var M;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(M||(M={}));var W;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(W||(W={}));class ie extends N{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}_("SystemBars",{web:()=>new ie});class y extends Error{type;status;retryable;constructor(t,n,s){super(t),this.name="ApiError",this.type=n,this.status=s,this.retryable=n==="NETWORK_ERROR"||n==="TIMEOUT"||n==="SERVER_ERROR"}}function G(e,t){if(e instanceof TypeError&&e.message.includes("fetch"))return new y("네트워크 연결을 확인해주세요.","NETWORK_ERROR");if(e instanceof DOMException&&e.name==="AbortError")return new y("요청 시간이 초과되었습니다.","TIMEOUT");if(t){if(t===401||t===403)return new y("인증이 필요합니다.","AUTH_ERROR",t);if(t===404)return new y("요청한 리소스를 찾을 수 없습니다.","NOT_FOUND",t);if(t===400)return new y("잘못된 요청입니다.","VALIDATION_ERROR",t);if(t>=500)return new y("서버에 문제가 발생했습니다. 잠시 후 다시 시도해주세요.","SERVER_ERROR",t)}const n=e instanceof Error?e.message:"알 수 없는 오류가 발생했습니다.";return new y(n,"UNKNOWN",t)}function K(){return typeof navigator<"u"?navigator.onLine:!0}function ae(){return j.isNativePlatform()?"https://shift-dev.kr":""}const F=ae(),C="auth_user";function oe(){if(typeof window>"u")return null;const e=localStorage.getItem(C);if(!e)return null;try{return JSON.parse(e)?.accessToken??null}catch{return null}}function ce(){if(typeof window>"u")return null;const e=localStorage.getItem(C);if(!e)return null;try{return JSON.parse(e)?.refreshToken??null}catch{return null}}function ue(e,t){if(typeof window>"u")return;const n=localStorage.getItem(C);if(n)try{const s=JSON.parse(n);s.accessToken=e,s.refreshToken=t,localStorage.setItem(C,JSON.stringify(s))}catch{}}function de(){typeof window<"u"&&(localStorage.removeItem(C),window.dispatchEvent(new CustomEvent("auth:expired")))}let J=!1,k=null;async function le(){if(J&&k)return k;const e=ce();return e?(J=!0,k=(async()=>{try{const t=await fetch(`${F}/api/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!t.ok)return!1;const n=await t.json();return n.success&&n.accessToken&&n.refreshToken?(ue(n.accessToken,n.refreshToken),!0):!1}catch{return!1}finally{J=!1,k=null}})(),k):!1}function O(e){const t=new URLSearchParams;Object.entries(e).forEach(([s,r])=>{r==null||r===""||t.set(s,String(r))});const n=t.toString();return n?`?${n}`:""}const fe=15e3;async function a(e,t,n=!1,s=!1){if(!K())throw new y("인터넷에 연결되어 있지 않습니다.","NETWORK_ERROR");const r={...t?.headers??{}};if(n){const u=oe();u&&(r.Authorization=`Bearer ${u}`)}const i=new AbortController,d=setTimeout(()=>i.abort(),fe);let o;try{o=await fetch(`${F}${e}`,{...t,headers:r,signal:i.signal})}catch(u){throw clearTimeout(d),G(u)}finally{clearTimeout(d)}if(o.status===401&&n&&!s){if(await le())return a(e,t,n,!0);throw de(),new y("인증이 만료되었습니다. 다시 로그인해주세요.","AUTH_ERROR",401)}if(!o.ok){const u=await o.text().catch(()=>"");let h="";try{const c=JSON.parse(u);h=c.message||c.error||""}catch{h=u}const T=G(null,o.status);throw h&&(T.message=h),T}return await o.json()}function he(e){return a(`/api/cards${O({group:e.group,status:e.status??"ACTIVE",from:e.from,to:e.to,limit:e.limit??20,offset:e.offset??0})}`,void 0,!0)}function pe(e){return a(`/api/cards/${e}`,void 0,!0)}function ge(e={}){return a(`/api/trending${O({hours:e.hours??3,limit:e.limit??10})}`,void 0,!0)}function me(e={}){return a(`/api/trending/popular${O({limit:e.limit??10})}`,void 0,!0)}function ye(e){return a("/api/auth/email/send-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function we(e){return a("/api/auth/email/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function be(e){return a("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function ve(e){return a("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function Te(e){return a(`/api/auth/check-username${O({username:e})}`)}function Ee(e){return a("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})})}function Oe(e){return a("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})})}function Pe(e){return a("/api/auth/password/send-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function Se(e){return a("/api/auth/password/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function ke(e){return a("/api/auth/terms/agree",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function Ce(e){return a("/api/auth/find-username",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function Ae(){try{return(await a("/api/users/settings",void 0,!0)).data}catch{return null}}function Le(e){return a("/api/users/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},!0)}function Re(e){return a(`/api/bookmarks/${e}`,{method:"POST"},!0)}function je(e){return a(`/api/bookmarks/${e}`,{method:"DELETE"},!0)}function Ue(e){return a(`/api/bookmarks/${e}/status`,void 0,!0)}function $e(){return a("/api/bookmarks",void 0,!0)}function xe(){return a("/api/admin/dashboard",void 0,!0)}function Je(e=30){return a(`/api/admin/stats/signups${O({days:e})}`,void 0,!0)}function _e(e=30){return a(`/api/admin/stats/views${O({days:e})}`,void 0,!0)}function Ne(){return a("/api/admin/stats/gender",void 0,!0)}function De(){return a("/api/admin/stats/age-groups",void 0,!0)}function Ie(e={}){return a(`/api/admin/users${O({page:e.page??1,size:e.size??20,search:e.search})}`,void 0,!0)}function Be(e,t){return a(`/api/admin/users/${e}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:t})},!0)}function He(e){return a(`/api/admin/users/${e}`,{method:"DELETE"},!0)}function Me(){return a("/api/admin/grades",void 0,!0)}function We(){return a("/api/admin/stats/grades",void 0,!0)}function Ge(e,t){return a(`/api/admin/users/${e}/grade`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({grade:t})},!0)}async function Ke(){const e=await a("/api/users/me",void 0,!0);if(!e.success||!e.data)throw new Error(e.message||"프로필을 불러올 수 없습니다.");return e.data}function Fe(e){return a("/api/users/me",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})},!0)}function Ve(e){return a("/api/users/me/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},!0)}function qe(e){return a("/api/users/me/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},!0)}function ze(e){const t=Xe();return a("/api/push/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,platform:t})},!0)}function Qe(e){return a("/api/push/token",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})},!0)}function Ye(e){return a("/api/push/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},!0)}function Xe(){if(typeof window>"u")return"web";const e=navigator.userAgent.toLowerCase();return/android/.test(e)?"android":/iphone|ipad|ipod/.test(e)?"ios":"web"}const Ze=Object.freeze(Object.defineProperty({__proto__:null,ApiError:y,addBookmark:Re,agreeToTerms:ke,changePassword:Ve,checkUsername:Te,deleteMyAccount:Fe,deleteUser:He,findUsername:Ce,getAdminAgeGroupStats:De,getAdminDashboard:xe,getAdminGenderStats:Ne,getAdminGradeStats:We,getAdminGrades:Me,getAdminSignupStats:Je,getAdminUsers:Ie,getAdminViewStats:_e,getBookmarkStatus:Ue,getCard:pe,getMyBookmarks:$e,getMyProfile:Ke,getPopularCards:me,getTrending:ge,getUserSettings:Ae,isOnline:K,listCards:he,login:ve,logout:Oe,refreshToken:Ee,registerPushToken:ze,removeBookmark:je,resetPassword:Se,sendEmailVerification:ye,sendPasswordResetEmail:Pe,signUp:be,unregisterPushToken:Qe,updateProfile:qe,updatePushSettings:Ye,updateUserGrade:Ge,updateUserRole:Be,updateUserSettings:Le,verifyEmail:we},Symbol.toStringTag,{value:"Module"}));export{y as A,Se as B,_ as C,j as D,Te as E,ye as F,be as G,we as H,Ke as I,Fe as J,Ve as K,qe as L,ke as M,Ze as N,N as W,ve as a,he as b,ge as c,me as d,xe as e,Je as f,Ae as g,_e as h,Ne as i,De as j,We as k,Oe as l,Me as m,Ie as n,He as o,Ge as p,Be as q,Ee as r,$e as s,je as t,Le as u,pe as v,Ue as w,Re as x,Pe as y,Ce as z};
