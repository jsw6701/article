import{d as I,w as V}from"./D2Z1D5OA.js";var P;(function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"})(P||(P={}));class x extends Error{constructor(t,r,a){super(t),this.message=t,this.code=r,this.data=a}}const N=e=>{var t,r;return e?.androidBridge?"android":!((r=(t=e?.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},Y=e=>{const t=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},a=r.Plugins=r.Plugins||{},n=()=>t!==null?t.name:N(e),s=()=>n()!=="web",i=u=>{const d=p.get(u);return!!(d?.platforms.has(n())||c(u))},c=u=>{var d;return(d=r.PluginHeaders)===null||d===void 0?void 0:d.find(A=>A.name===u)},f=u=>e.console.error(u),p=new Map,C=(u,d={})=>{const A=p.get(u);if(A)return console.warn(`Capacitor plugin "${u}" already registered. Cannot register plugins twice.`),A.proxy;const v=n(),S=c(u);let y;const q=async()=>(!y&&v in d?y=typeof d[v]=="function"?y=await d[v]():y=d[v]:t!==null&&!y&&"web"in d&&(y=typeof d.web=="function"?y=await d.web():y=d.web),y),K=(l,h)=>{var m,w;if(S){const b=S?.methods.find(g=>h===g.name);if(b)return b.rtype==="promise"?g=>r.nativePromise(u,h.toString(),g):(g,L)=>r.nativeCallback(u,h.toString(),g,L);if(l)return(m=l[h])===null||m===void 0?void 0:m.bind(l)}else{if(l)return(w=l[h])===null||w===void 0?void 0:w.bind(l);throw new x(`"${u}" plugin is not implemented on ${v}`,P.Unimplemented)}},U=l=>{let h;const m=(...w)=>{const b=q().then(g=>{const L=K(g,l);if(L){const O=L(...w);return h=O?.remove,O}else throw new x(`"${u}.${l}()" is not implemented on ${v}`,P.Unimplemented)});return l==="addListener"&&(b.remove=async()=>h()),b};return m.toString=()=>`${l.toString()}() { [capacitor code] }`,Object.defineProperty(m,"name",{value:l,writable:!1,configurable:!1}),m},R=U("addListener"),H=U("removeListener"),z=(l,h)=>{const m=R({eventName:l},h),w=async()=>{const g=await m;H({eventName:l,callbackId:g},h)},b=new Promise(g=>m.then(()=>g({remove:w})));return b.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await w()},b},j=new Proxy({},{get(l,h){switch(h){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return S?z:R;case"removeListener":return H;default:return U(h)}}});return a[u]=j,p.set(u,{name:u,proxy:j,platforms:new Set([...Object.keys(d),...S?[v]:[]])}),j};return r.convertFileSrc||(r.convertFileSrc=u=>u),r.getPlatform=n,r.handleError=f,r.isNativePlatform=s,r.isPluginAvailable=i,r.registerPlugin=C,r.Exception=x,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},Q=e=>e.Capacitor=Y(e),$=Q(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),B=$.registerPlugin;class D{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(t,r){let a=!1;this.listeners[t]||(this.listeners[t]=[],a=!0),this.listeners[t].push(r);const s=this.windowListeners[t];s&&!s.registered&&this.addWindowListener(s),a&&this.sendRetainedArgumentsForEvent(t);const i=async()=>this.removeListener(t,r);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r,a){const n=this.listeners[t];if(!n){if(a){let s=this.retainedEventArguments[t];s||(s=[]),s.push(r),this.retainedEventArguments[t]=s}return}n.forEach(s=>s(r))}hasListeners(t){var r;return!!(!((r=this.listeners[t])===null||r===void 0)&&r.length)}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:a=>{this.notifyListeners(r,a)}}}unimplemented(t="not implemented"){return new $.Exception(t,P.Unimplemented)}unavailable(t="not available"){return new $.Exception(t,P.Unavailable)}async removeListener(t,r){const a=this.listeners[t];if(!a)return;const n=a.indexOf(r);this.listeners[t].splice(n,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}sendRetainedArgumentsForEvent(t){const r=this.retainedEventArguments[t];r&&(delete this.retainedEventArguments[t],r.forEach(a=>{this.notifyListeners(t,a)}))}}const _=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),G=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class X extends D{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(a=>{if(a.length<=0)return;let[n,s]=a.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=G(n).trim(),s=G(s).trim(),r[n]=s}),r}async setCookie(t){try{const r=_(t.key),a=_(t.value),n=`; expires=${(t.expires||"").replace("expires=","")}`,s=(t.path||"/").replace("path=",""),i=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${a||""}${n}; path=${s}; ${i};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}B("CapacitorCookies",{web:()=>new X});const Z=async e=>new Promise((t,r)=>{const a=new FileReader;a.onload=()=>{const n=a.result;t(n.indexOf(",")>=0?n.split(",")[1]:n)},a.onerror=n=>r(n),a.readAsDataURL(e)}),ee=(e={})=>{const t=Object.keys(e);return Object.keys(e).map(n=>n.toLocaleLowerCase()).reduce((n,s,i)=>(n[s]=e[t[i]],n),{})},te=(e,t=!0)=>e?Object.entries(e).reduce((a,n)=>{const[s,i]=n;let c,f;return Array.isArray(i)?(f="",i.forEach(p=>{c=t?encodeURIComponent(p):p,f+=`${s}=${c}&`}),f.slice(0,-1)):(c=t?encodeURIComponent(i):i,f=`${s}=${c}`),`${a}&${f}`},"").substr(1):null,re=(e,t={})=>{const r=Object.assign({method:e.method||"GET",headers:e.headers},t),n=ee(e.headers)["content-type"]||"";if(typeof e.data=="string")r.body=e.data;else if(n.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[i,c]of Object.entries(e.data||{}))s.set(i,c);r.body=s.toString()}else if(n.includes("multipart/form-data")||e.data instanceof FormData){const s=new FormData;if(e.data instanceof FormData)e.data.forEach((c,f)=>{s.append(f,c)});else for(const c of Object.keys(e.data))s.append(c,e.data[c]);r.body=s;const i=new Headers(r.headers);i.delete("content-type"),r.headers=i}else(n.includes("application/json")||typeof e.data=="object")&&(r.body=JSON.stringify(e.data));return r};class ne extends D{async request(t){const r=re(t,t.webFetchExtra),a=te(t.params,t.shouldEncodeUrlParams),n=a?`${t.url}?${a}`:t.url,s=await fetch(n,r),i=s.headers.get("content-type")||"";let{responseType:c="text"}=s.ok?t:{};i.includes("application/json")&&(c="json");let f,p;switch(c){case"arraybuffer":case"blob":p=await s.blob(),f=await Z(p);break;case"json":f=await s.json();break;default:f=await s.text()}const C={};return s.headers.forEach((u,d)=>{C[d]=u}),{data:f,headers:C,status:s.status,url:s.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}B("CapacitorHttp",{web:()=>new ne});var M;(function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"})(M||(M={}));var W;(function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"})(W||(W={}));class se extends D{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}B("SystemBars",{web:()=>new se});function ae(){return $.isNativePlatform()?"https://shift-dev.kr":""}const ie=ae(),F="auth_user";function oe(){if(typeof window>"u")return null;const e=localStorage.getItem(F);if(!e)return null;try{return JSON.parse(e)?.accessToken??null}catch{return null}}function ce(){typeof window<"u"&&(localStorage.removeItem(F),window.dispatchEvent(new CustomEvent("auth:expired")))}function E(e){const t=new URLSearchParams;Object.entries(e).forEach(([a,n])=>{n==null||n===""||t.set(a,String(n))});const r=t.toString();return r?`?${r}`:""}async function o(e,t,r=!1){const a={...t?.headers??{}};if(r){const s=oe();s&&(a.Authorization=`Bearer ${s}`)}const n=await fetch(`${ie}${e}`,{...t,headers:a});if(n.status===401&&r)throw ce(),new Error("인증이 만료되었습니다. 다시 로그인해주세요.");if(!n.ok){const s=await n.text().catch(()=>"");throw new Error(`API ${n.status} ${n.statusText}: ${s}`)}return await n.json()}function ge(e){return o(`/api/cards${E({group:e.group,status:e.status??"ACTIVE",from:e.from,to:e.to,limit:e.limit??20,offset:e.offset??0})}`,void 0,!0)}function me(e){return o(`/api/cards/${e}`,void 0,!0)}function pe(e={}){return o(`/api/trending${E({hours:e.hours??3,limit:e.limit??10})}`,void 0,!0)}function ye(e={}){return o(`/api/trending/popular${E({limit:e.limit??10})}`,void 0,!0)}function we(e){return o("/api/auth/email/send-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function be(e){return o("/api/auth/email/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function ve(e){return o("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function ue(e){return o("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function ke(e){return o(`/api/auth/check-username${E({username:e})}`)}function de(e){return o("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})})}function le(e){return o("/api/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e})})}async function Ee(){try{return(await o("/api/users/settings",void 0,!0)).data}catch{return null}}function Se(e){return o("/api/users/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)},!0)}function Pe(e){return o(`/api/bookmarks/${e}`,{method:"POST"},!0)}function Te(e){return o(`/api/bookmarks/${e}`,{method:"DELETE"},!0)}function Ce(e){return o(`/api/bookmarks/${e}/status`,void 0,!0)}function Ae(){return o("/api/bookmarks",void 0,!0)}function Le(){return o("/api/admin/dashboard",void 0,!0)}function Oe(e=30){return o(`/api/admin/stats/signups${E({days:e})}`,void 0,!0)}function $e(e=30){return o(`/api/admin/stats/views${E({days:e})}`,void 0,!0)}function Ue(){return o("/api/admin/stats/gender",void 0,!0)}function je(){return o("/api/admin/stats/age-groups",void 0,!0)}function xe(e={}){return o(`/api/admin/users${E({page:e.page??1,size:e.size??20,search:e.search})}`,void 0,!0)}function Ie(e,t){return o(`/api/admin/users/${e}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:t})},!0)}function Be(e){return o(`/api/admin/users/${e}`,{method:"DELETE"},!0)}function De(){return o("/api/admin/grades",void 0,!0)}function Je(){return o("/api/admin/stats/grades",void 0,!0)}function Re(e,t){return o(`/api/admin/users/${e}/grade`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({grade:t})},!0)}async function He(){const e=await o("/api/users/me",void 0,!0);if(!e.success||!e.data)throw new Error(e.message||"프로필을 불러올 수 없습니다.");return e.data}function _e(e){return o("/api/users/me",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})},!0)}const k="auth_user";function T(){if(typeof window>"u")return null;const e=localStorage.getItem(k);if(!e)return null;try{return JSON.parse(e)}catch{return null}}function fe(){const e=typeof window<"u"?T():null,{subscribe:t,set:r,update:a}=V(e);return{subscribe:t,init(){const n=T();r(n)},async login(n,s){try{const i=await ue({username:n,password:s});if(i.success&&i.accessToken&&i.refreshToken&&i.userId&&i.username&&i.role){const c={userId:i.userId,username:i.username,role:i.role,accessToken:i.accessToken,refreshToken:i.refreshToken};return r(c),localStorage.setItem(k,JSON.stringify(c)),{success:!0,message:"로그인 성공"}}return{success:!1,message:i.message??"로그인 실패"}}catch{return{success:!1,message:"서버 오류가 발생했습니다."}}},async logout(){const n=T();if(n)try{await le(n.userId)}catch{}r(null),localStorage.removeItem(k)},clear(){r(null),localStorage.removeItem(k)},async refresh(){const n=T();if(!n)return!1;try{const s=await de(n.refreshToken);if(s.success&&s.accessToken&&s.refreshToken){const i={...n,accessToken:s.accessToken,refreshToken:s.refreshToken};return r(i),localStorage.setItem(k,JSON.stringify(i)),!0}return r(null),localStorage.removeItem(k),!1}catch{return r(null),localStorage.removeItem(k),!1}},getAccessToken(){return T()?.accessToken??null}}}const J=fe(),Ge=I(J,e=>e!==null),Me=I(J,e=>e),We=I(J,e=>e?.role==="ADMIN");export{_e as A,ke as B,we as C,ve as D,be as E,pe as a,ye as b,We as c,Le as d,Oe as e,$e as f,Ee as g,Ue as h,Ge as i,je as j,Je as k,ge as l,Me as m,De as n,xe as o,Be as p,Re as q,Ie as r,Ae as s,Te as t,Se as u,me as v,Ce as w,Pe as x,J as y,He as z};
