import{d as u,w as y,g as S}from"./D2Z1D5OA.js";import{g as p,u as T,i as d}from"./C8ccASB2.js";const o={theme:"light",fontSize:"medium",startPage:"home"},h="user_settings";function f(){try{const e=localStorage.getItem(h);if(e)return{...o,...JSON.parse(e)}}catch(e){console.error("Failed to parse settings:",e)}return o}function r(e){localStorage.setItem(h,JSON.stringify(e))}function i(e){document.documentElement.setAttribute("data-theme",e.theme),document.documentElement.setAttribute("data-font-size",e.fontSize)}function v(){const{subscribe:e,set:l,update:c}=y(f());let g=null;async function a(s){S(d)&&(g&&clearTimeout(g),g=setTimeout(async()=>{try{await T(s)}catch(n){console.error("Failed to sync settings to server:",n)}},1e3))}return{subscribe:e,init:async()=>{let s=f();if(S(d))try{const n=await p();n&&(s={...o,...n},r(s))}catch(n){console.error("Failed to fetch settings from server:",n)}i(s),l(s)},setTheme:s=>{c(n=>{const t={...n,theme:s};return r(t),i(t),a(t),t})},toggleTheme:()=>{c(s=>{const n=s.theme==="dark"?"light":"dark",t={...s,theme:n};return r(t),i(t),a(t),t})},setFontSize:s=>{c(n=>{const t={...n,fontSize:s};return r(t),i(t),a(t),t})},setStartPage:s=>{c(n=>{const t={...n,startPage:s};return r(t),a(t),t})},update:s=>{c(n=>{const t={...n,...s};return r(t),i(t),a(t),t})},reset:()=>{r(o),i(o),l(o),a(o)}}}const m=v();u(m,e=>e.theme);u(m,e=>e.fontSize);const b=u(m,e=>e.startPage);export{b as c,m as s};
