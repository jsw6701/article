const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DTbKOmxA.js","../chunks/Do2HDaJV.js"])))=>i.map(i=>d[i]);
import{c as $,a as l,f as z,b as Z}from"../chunks/TFX7ugsA.js";import"../chunks/D6SK0GIy.js";import{o as Ta,a as ae,d as ee,w as Ca,g as ya}from"../chunks/DujhYGdh.js";import{h as te,H as re,v as se,aI as oe,b5 as ne,aG as ie,e as le,u as G,b6 as ce,a_ as Ia,b7 as ve,q as fe,aa,p as ka,f as L,a as Aa,o as _,Y,g as r,c as O,b as E,t as ta,s as W,ao as la,ap as de}from"../chunks/C9SIyTFa.js";import{a as ue,i as B,s as ga,e as ea}from"../chunks/bwNj2O70.js";import{e as pe}from"../chunks/DShnAKY6.js";import{s as he}from"../chunks/xoXkTC80.js";import{s as _a}from"../chunks/lJrTxOp0.js";import{i as Na}from"../chunks/CSrNcNRV.js";import{s as qa,a as da}from"../chunks/9ZnQYv7J.js";import{b as M}from"../chunks/DJmzTC8u.js";import{p as ge}from"../chunks/CF3dsMkf.js";import{g as ca}from"../chunks/DMPJ66L7.js";import{b as va,i as Da,a as _e}from"../chunks/CMcePfVQ.js";import{s as me,c as we}from"../chunks/DHsHBKWo.js";import{a as be}from"../chunks/BtnAkzHr.js";/* empty css                */import{s as ke}from"../chunks/6RZwXm1a.js";import{C as Ae,D as La}from"../chunks/Do2HDaJV.js";import{_ as Ne}from"../chunks/PPVm8Dsz.js";function Le(a,e,t,s,d){te&&re();var c=e.$$slots?.[t],v=!1;c===!0&&(c=e.children,v=!0),c===void 0||c(a,v?()=>s:s)}const Ee=()=>performance.now(),S={tick:a=>requestAnimationFrame(a),now:()=>Ee(),tasks:new Set};function Va(){const a=S.now();S.tasks.forEach(e=>{e.c(a)||(S.tasks.delete(e),e.f())}),S.tasks.size!==0&&S.tick(Va)}function ye(a){let e;return S.tasks.size===0&&S.tick(Va),{promise:new Promise(t=>{S.tasks.add(e={c:a,f:t})}),abort(){S.tasks.delete(e)}}}function fa(a,e){Ia(()=>{a.dispatchEvent(new CustomEvent(e))})}function De(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Oa(a){const e={},t=a.split(";");for(const s of t){const[d,c]=s.split(":");if(!d||c===void 0)break;const v=De(d.trim());e[v]=c.trim()}return e}const Oe=a=>a;function Be(a,e,t,s){var d=(a&ce)!==0,c="both",v,g=e.inert,w=e.style.overflow,p,f;function n(){return Ia(()=>v??=t()(e,s?.()??{},{direction:c}))}var u={is_global:d,in(){e.inert=g,fa(e,"introstart"),p=ma(e,n(),f,1,()=>{fa(e,"introend"),p?.abort(),p=v=void 0,e.style.overflow=w})},out(y){e.inert=!0,fa(e,"outrostart"),f=ma(e,n(),p,0,()=>{fa(e,"outroend"),y?.()})},stop:()=>{p?.abort(),f?.abort()}},P=se;if((P.nodes.t??=[]).push(u),ue){var b=d;if(!b){for(var i=P.parent;i&&(i.f&oe)!==0;)for(;(i=i.parent)&&(i.f&ne)===0;);b=!i||(i.f&ie)!==0}b&&le(()=>{G(()=>u.in())})}}function ma(a,e,t,s,d){var c=s===1;if(ve(e)){var v,g=!1;return fe(()=>{if(!g){var y=e({direction:c?"in":"out"});v=ma(a,y,t,s,d)}}),{abort:()=>{g=!0,v?.abort()},deactivate:()=>v.deactivate(),reset:()=>v.reset(),t:()=>v.t()}}if(t?.deactivate(),!e?.duration)return d(),{abort:aa,deactivate:aa,reset:aa,t:()=>s};const{delay:w=0,css:p,tick:f,easing:n=Oe}=e;var u=[];if(c&&t===void 0&&(f&&f(0,1),p)){var P=Oa(p(0,1));u.push(P,P)}var b=()=>1-s,i=a.animate(u,{duration:w,fill:"forwards"});return i.onfinish=()=>{i.cancel();var y=t?.t()??1-s;t?.abort();var K=s-y,k=e.duration*Math.abs(K),I=[];if(k>0){var q=!1;if(p)for(var V=Math.ceil(k/16.666666666666668),U=0;U<=V;U+=1){var A=y+K*n(U/V),T=Oa(p(A,1-A));I.push(T),q||=T.overflow==="hidden"}q&&(a.style.overflow="hidden"),b=()=>{var C=i.currentTime;return y+K*n(C/k)},f&&ye(()=>{if(i.playState!=="running")return!1;var C=b();return f(C,1-C),!0})}i=a.animate(I,{duration:k,fill:"forwards"}),i.onfinish=()=>{b=()=>s,f?.(s,1-s),d()}},{abort:()=>{i&&(i.cancel(),i.effect=null,i.onfinish=aa)},deactivate:()=>{d=aa},reset:()=>{s===0&&f?.(1,0)},t:()=>b()}}var wa;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.UPDATE_NOT_AVAILABLE=1]="UPDATE_NOT_AVAILABLE",a[a.UPDATE_AVAILABLE=2]="UPDATE_AVAILABLE",a[a.UPDATE_IN_PROGRESS=3]="UPDATE_IN_PROGRESS"})(wa||(wa={}));var j;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.PENDING=1]="PENDING",a[a.DOWNLOADING=2]="DOWNLOADING",a[a.INSTALLING=3]="INSTALLING",a[a.INSTALLED=4]="INSTALLED",a[a.FAILED=5]="FAILED",a[a.CANCELED=6]="CANCELED",a[a.DOWNLOADED=11]="DOWNLOADED"})(j||(j={}));var Ba;(function(a){a[a.OK=0]="OK",a[a.CANCELED=1]="CANCELED",a[a.FAILED=2]="FAILED",a[a.NOT_AVAILABLE=3]="NOT_AVAILABLE",a[a.NOT_ALLOWED=4]="NOT_ALLOWED",a[a.INFO_MISSING=5]="INFO_MISSING"})(Ba||(Ba={}));const ua=Ae("AppUpdate",{web:()=>Ne(()=>import("../chunks/DTbKOmxA.js"),__vite__mapDeps([0,1]),import.meta.url).then(a=>new a.AppUpdateWeb)});async function Pe(){if(!La.isNativePlatform())return console.log("[AppUpdate] Not a native platform, skipping update check"),{updateAvailable:!1};try{const a=await ua.getAppUpdateInfo();console.log("[AppUpdate] Update info:",{updateAvailability:a.updateAvailability,availableVersionName:a.availableVersionName,currentVersionName:a.currentVersionName,availableVersionCode:a.availableVersionCode,currentVersionCode:a.currentVersionCode});const e=a.updateAvailability===wa.UPDATE_AVAILABLE;return console.log("[AppUpdate] Update available:",e),{updateAvailable:e,currentVersion:a.currentVersionName,availableVersion:a.availableVersionName}}catch(a){return console.error("[AppUpdate] Failed to check for update:",a),{updateAvailable:!1}}}async function Te(){if(!La.isNativePlatform())return console.log("[AppUpdate] Not native platform, skipping"),!1;try{console.log("[AppUpdate] Calling startFlexibleUpdate...");const a=await ua.startFlexibleUpdate();return console.log("[AppUpdate] startFlexibleUpdate response:",a),!0}catch(a){return console.error("[AppUpdate] Failed to start flexible update:",a),!1}}async function Ce(){if(La.isNativePlatform())try{await ua.completeFlexibleUpdate()}catch(a){console.error("Failed to complete flexible update:",a)}}function Ie(a){return ua.addListener("onFlexibleUpdateStateChange",a)}var qe=z('<span class="message svelte-1ck5qw8"> </span> <div class="actions svelte-1ck5qw8"><button class="dismiss svelte-1ck5qw8">나중에</button> <button class="update svelte-1ck5qw8">업데이트</button></div>',1),Ve=z('<span class="message svelte-1ck5qw8"> </span> <div class="progress-bar svelte-1ck5qw8"><div class="progress svelte-1ck5qw8"></div></div>',1),Ue=z('<span class="message svelte-1ck5qw8">업데이트 준비 완료</span> <div class="actions svelte-1ck5qw8"><button class="dismiss svelte-1ck5qw8">나중에</button> <button class="update svelte-1ck5qw8">지금 설치</button></div>',1),xe=z('<span class="message svelte-1ck5qw8">설치 중...</span>'),Me=z('<div><div class="content svelte-1ck5qw8"><!></div></div>');function $e(a,e){ka(e,!1);let t=Y("idle"),s=Y(0),d=Y(""),c=null;Ta(async()=>{console.log("[AppUpdateBanner] Checking for updates...");const n=await Pe();console.log("[AppUpdateBanner] Update check result:",n),n.updateAvailable&&(_(t,"available"),_(d,n.availableVersion||""),console.log("[AppUpdateBanner] Update available, showing banner"),c=await Ie(u=>{switch(console.log("[AppUpdateBanner] Update state change:",u),u.status){case j.DOWNLOADING:_(t,"downloading"),u.bytesDownloaded&&u.totalBytesToDownload&&(_(s,Math.round(u.bytesDownloaded/u.totalBytesToDownload*100)),console.log("[AppUpdateBanner] Download progress:",r(s)+"%"));break;case j.DOWNLOADED:_(t,"downloaded"),_(s,100),console.log("[AppUpdateBanner] Download complete");break;case j.INSTALLING:_(t,"installing");break;case j.INSTALLED:_(t,"idle");break;case j.FAILED:console.error("[AppUpdateBanner] Update failed"),_(t,"available");break;case j.CANCELED:console.log("[AppUpdateBanner] Update canceled"),_(t,"available");break}}))}),ae(()=>{c&&c.remove()});async function v(){if(r(t)==="available"){console.log("[AppUpdateBanner] Starting flexible update..."),_(t,"downloading");const n=await Te();console.log("[AppUpdateBanner] startFlexibleUpdate result:",n),n||(console.error("[AppUpdateBanner] Failed to start update"),_(t,"available"))}else r(t)==="downloaded"&&(console.log("[AppUpdateBanner] Completing update..."),_(t,"installing"),await Ce())}function g(){_(t,"idle")}Na();var w=$(),p=L(w);{var f=n=>{var u=Me();let P;var b=O(u),i=O(b);{var y=k=>{var I=qe(),q=L(I),V=O(q);E(q);var U=W(q,2),A=O(U),T=W(A,2);E(U),ta(()=>ga(V,`새 버전이 있습니다${r(d)?` (${r(d)})`:""}`)),ea("click",A,g),ea("click",T,v),l(k,I)},K=k=>{var I=$(),q=L(I);{var V=A=>{var T=Ve(),C=L(T),h=O(C);E(C);var D=W(C,2),m=O(D);E(D),ta(()=>{ga(h,`다운로드 중... ${r(s)??""}%`),ke(m,`width: ${r(s)??""}%`)}),l(A,T)},U=A=>{var T=$(),C=L(T);{var h=m=>{var o=Ue(),N=W(L(o),2),x=O(N),F=W(x,2);E(N),ea("click",x,g),ea("click",F,v),l(m,o)},D=m=>{var o=$(),N=L(o);{var x=F=>{var pa=xe();l(F,pa)};B(N,F=>{r(t)==="installing"&&F(x)},!0)}l(m,o)};B(C,m=>{r(t)==="downloaded"?m(h):m(D,!1)},!0)}l(A,T)};B(q,A=>{r(t)==="downloading"?A(V):A(U,!1)},!0)}l(k,I)};B(i,k=>{r(t)==="available"?k(y):k(K,!1)})}E(b),E(u),ta(()=>P=_a(u,1,"update-banner svelte-1ck5qw8",null,P,{downloading:r(t)==="downloading"})),l(n,u)};B(p,n=>{r(t)!=="idle"&&n(f)})}l(a,w),Aa()}function We(){const{subscribe:a,set:e}=Ca(navigator.onLine);return window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)),{subscribe:a}}const Fe=We();function Ge(){const{subscribe:a,set:e,update:t}=Ca({dismissed:!1,lastDismissed:0});return{subscribe:a,dismiss:()=>{t(s=>({...s,dismissed:!0,lastDismissed:Date.now()}))},reset:()=>{t(s=>({...s,dismissed:!1}))}}}const ba=Ge(),Se=ee([Fe,ba],([a,e])=>(a&&e.dismissed&&setTimeout(()=>ba.reset(),1e4),!a&&!e.dismissed));function ze(a){const e=a-1;return e*e*e+1}function Pa(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function Ke(a,{delay:e=0,duration:t=400,easing:s=ze,x:d=0,y:c=0,opacity:v=0}={}){const g=getComputedStyle(a),w=+g.opacity,p=g.transform==="none"?"":g.transform,f=w*(1-v),[n,u]=Pa(d),[P,b]=Pa(c);return{delay:e,duration:t,easing:s,css:(i,y)=>`
			transform: ${p} translate(${(1-i)*n}${u}, ${(1-i)*P}${b});
			opacity: ${w-f*y}`}}var He=z('<div class="offline-banner svelte-l46k7l" role="alert"><div class="banner-content svelte-l46k7l"><svg viewBox="0 0 24 24" fill="none" class="banner-icon svelte-l46k7l" width="20" height="20"><path d="M1 1l22 22M9 9a6 6 0 008.5 8.5M5.64 5.64A10 10 0 0019 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><circle cx="12" cy="18" r="1" fill="currentColor"></circle></svg> <span class="banner-text svelte-l46k7l">오프라인 상태입니다</span></div> <button class="dismiss-btn svelte-l46k7l" aria-label="닫기"><svg viewBox="0 0 24 24" fill="none" width="18" height="18"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg></button></div>');function je(a,e){ka(e,!1);const t=()=>da(Se,"$showOfflineBanner",s),[s,d]=qa();function c(){ba.dismiss()}Na();var v=$(),g=L(v);{var w=p=>{var f=He(),n=W(O(f),2);E(f),ea("click",n,c),Be(3,f,()=>Ke,()=>({y:-50,duration:300})),l(p,f)};B(g,p=>{t()&&p(w)})}l(a,v),Aa(),d()}var Ye=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M3 9.5L12 3l9 6.5V20a1 1 0 01-1 1h-5v-6a1 1 0 00-1-1h-4a1 1 0 00-1 1v6H4a1 1 0 01-1-1V9.5z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path></svg>'),Je=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.8"></rect><path d="M8 8h8M8 12h8M8 16h5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path></svg>'),Qe=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M3 17l6-6 4 4 8-8" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17 7h4v4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),Re=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-4-7 4V5z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path></svg>'),Xe=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="1.8"></circle><path d="M4 20c0-4 4-6 8-6s8 2 8 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path></svg>'),Ze=Z('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="currentColor" stroke-width="1.8"></path><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 114 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="1.8"></path></svg>'),at=z('<a><div class="tab-icon svelte-12qhfyh"><!></div> <span class="tab-label svelte-12qhfyh"> </span></a>'),et=z('<nav class="tab-bar svelte-12qhfyh"></nav>'),tt=z('<!> <!> <div class="app svelte-12qhfyh"><main><!></main> <!></div>',1);function Nt(a,e){ka(e,!1);const t=()=>da(Da,"$isLoggedIn",c),s=()=>da(ge,"$page",c),d=()=>da(_e,"$isAdmin",c),[c,v]=qa(),g=Y(),w=Y(),p=Y(),f=["/login","/signup","/privacy","/terms","/forgot-password","/find-username"];let n=Y(!1),u=!1;const P={home:"/",feed:"/today",trending:"/trending"};Ta(async()=>{va.init(),await me.init(),_(n,!0);const h=window.location.pathname.replace(M,"")||"/",D=f.some(o=>h.startsWith(o));if(ya(Da)){if(!await va.refresh()&&!D){va.clear(),ca(`${M}/login`);return}if(h==="/"&&!u){const N=ya(we),x=P[N]||"/";x!=="/"&&(u=!0,ca(`${M}${x}`,{replaceState:!0}))}await be.init()}const m=()=>{va.clear(),ca(`${M}/login`)};return window.addEventListener("auth:expired",m),()=>window.removeEventListener("auth:expired",m)});function b(h,D){if(!r(n))return;const m=D.replace(M,"")||"/",o=f.some(N=>m.startsWith(N));!h&&!o&&ca(`${M}/login`)}function i(h){return h==="/"?r(g)==="/"||r(g)===M+"/":r(g).includes(h)}const y=[{path:"/",label:"홈",icon:"home",show:"always"},{path:"/today",label:"피드",icon:"feed",show:"always"},{path:"/trending",label:"트렌드",icon:"trend",show:"always"},{path:"/bookmarks",label:"저장",icon:"bookmark",show:"logged-in"},{path:"/mypage",label:"MY",icon:"user",show:"logged-in"},{path:"/admin",label:"관리",icon:"admin",show:"admin"}];la(()=>(r(n),t(),s()),()=>{r(n)&&b(t(),s().url.pathname)}),la(()=>s(),()=>{_(g,s().url.pathname)}),la(()=>(r(g),M),()=>{_(w,f.some(h=>(r(g).replace(M,"")||"/").startsWith(h)))}),la(()=>(t(),d()),()=>{_(p,y.filter(h=>h.show==="always"?!0:h.show==="logged-in"?t():h.show==="admin"?d():!1))}),de(),Na();var K=tt(),k=L(K);$e(k,{});var I=W(k,2);je(I,{});var q=W(I,2),V=O(q);let U;var A=O(V);Le(A,e,"default",{}),E(V);var T=W(V,2);{var C=h=>{var D=et();pe(D,5,()=>r(p),m=>m.path,(m,o)=>{var N=at();let x;var F=O(N),pa=O(F);{var Ua=H=>{var ra=Ye();l(H,ra)},xa=H=>{var ra=$(),$a=L(ra);{var Wa=J=>{var sa=Je();l(J,sa)},Fa=J=>{var sa=$(),Ga=L(sa);{var Sa=Q=>{var oa=Qe();l(Q,oa)},za=Q=>{var oa=$(),Ka=L(oa);{var Ha=R=>{var na=Re();l(R,na)},ja=R=>{var na=$(),Ya=L(na);{var Ja=X=>{var ia=Xe();l(X,ia)},Qa=X=>{var ia=$(),Ra=L(ia);{var Xa=ha=>{var Za=Ze();l(ha,Za)};B(Ra,ha=>{r(o),G(()=>r(o).icon==="admin")&&ha(Xa)},!0)}l(X,ia)};B(Ya,X=>{r(o),G(()=>r(o).icon==="user")?X(Ja):X(Qa,!1)},!0)}l(R,na)};B(Ka,R=>{r(o),G(()=>r(o).icon==="bookmark")?R(Ha):R(ja,!1)},!0)}l(Q,oa)};B(Ga,Q=>{r(o),G(()=>r(o).icon==="trend")?Q(Sa):Q(za,!1)},!0)}l(J,sa)};B($a,J=>{r(o),G(()=>r(o).icon==="feed")?J(Wa):J(Fa,!1)},!0)}l(H,ra)};B(pa,H=>{r(o),G(()=>r(o).icon==="home")?H(Ua):H(xa,!1)})}E(F);var Ea=W(F,2),Ma=O(Ea,!0);E(Ea),E(N),ta(H=>{x=_a(N,1,"tab-item svelte-12qhfyh",null,x,H),he(N,"href",`${M??""}${r(o),G(()=>r(o).path==="/"?"/":r(o).path)??""}`),ga(Ma,(r(o),G(()=>r(o).label)))},[()=>({active:i(r(o).path)})]),l(m,N)}),E(D),l(h,D)};B(T,h=>{r(w)||h(C)})}E(q),ta(()=>U=_a(V,1,"main svelte-12qhfyh",null,U,{"no-tabbar":r(w)})),l(a,K),Aa(),v()}export{Nt as component};
