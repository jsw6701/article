const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BavVy2A9.js","../chunks/95k2wcHO.js"])))=>i.map(i=>d[i]);
import{c as x,a as c,f as z,b as aa}from"../chunks/TFX7ugsA.js";import"../chunks/D6SK0GIy.js";import{o as Ua,a as ee,d as te,w as Ca,g as Da}from"../chunks/DujhYGdh.js";import{h as re,H as oe,v as se,aI as ne,b5 as ie,aG as le,e as ce,u as F,b6 as de,a_ as qa,b7 as fe,q as ve,aa as ea,p as Aa,f as L,a as Na,o as v,Y as J,g as r,c as O,b as y,t as ra,s as M,ao as ca,ap as pe}from"../chunks/C9SIyTFa.js";import{a as ue,i as P,s as ma,e as ta}from"../chunks/bwNj2O70.js";import{e as he}from"../chunks/DShnAKY6.js";import{s as ge}from"../chunks/xoXkTC80.js";import{s as _a}from"../chunks/lJrTxOp0.js";import{i as La}from"../chunks/CSrNcNRV.js";import{s as Va,a as pa}from"../chunks/9ZnQYv7J.js";import{b as V}from"../chunks/DvH0yMmo.js";import{p as me}from"../chunks/3-osnTrM.js";import{g as da}from"../chunks/De4q2J6q.js";import{b as fa,i as Ba,a as _e}from"../chunks/EHLbj6ui.js";import{s as Oa,c as we}from"../chunks/C4sVfP8L.js";import{a as be}from"../chunks/DdBKWmBV.js";/* empty css                */import{s as ke}from"../chunks/6RZwXm1a.js";import{C as Ae,D as ya}from"../chunks/95k2wcHO.js";import{_ as Ne}from"../chunks/PPVm8Dsz.js";function Le(a,e,t,o,p){re&&oe();var i=e.$$slots?.[t],u=!1;i===!0&&(i=e.children,u=!0),i===void 0||i(a,u?()=>o:o)}const ye=()=>performance.now(),S={tick:a=>requestAnimationFrame(a),now:()=>ye(),tasks:new Set};function xa(){const a=S.now();S.tasks.forEach(e=>{e.c(a)||(S.tasks.delete(e),e.f())}),S.tasks.size!==0&&S.tick(xa)}function Ee(a){let e;return S.tasks.size===0&&S.tick(xa),{promise:new Promise(t=>{S.tasks.add(e={c:a,f:t})}),abort(){S.tasks.delete(e)}}}function va(a,e){qa(()=>{a.dispatchEvent(new CustomEvent(e))})}function De(a){if(a==="float")return"cssFloat";if(a==="offset")return"cssOffset";if(a.startsWith("--"))return a;const e=a.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Pa(a){const e={},t=a.split(";");for(const o of t){const[p,i]=o.split(":");if(!p||i===void 0)break;const u=De(p.trim());e[u]=i.trim()}return e}const Be=a=>a;function Oe(a,e,t,o){var p=(a&de)!==0,i="both",u,g=e.inert,_=e.style.overflow,h,f;function m(){return qa(()=>u??=t()(e,o?.()??{},{direction:i}))}var s={is_global:p,in(){e.inert=g,va(e,"introstart"),h=wa(e,m(),f,1,()=>{va(e,"introend"),h?.abort(),h=u=void 0,e.style.overflow=_})},out(E){e.inert=!0,va(e,"outrostart"),f=wa(e,m(),h,0,()=>{va(e,"outroend"),E?.()})},stop:()=>{h?.abort(),f?.abort()}},k=se;if((k.nodes.t??=[]).push(s),ue){var w=p;if(!w){for(var l=k.parent;l&&(l.f&ne)!==0;)for(;(l=l.parent)&&(l.f&ie)===0;);w=!l||(l.f&le)!==0}w&&ce(()=>{F(()=>s.in())})}}function wa(a,e,t,o,p){var i=o===1;if(fe(e)){var u,g=!1;return ve(()=>{if(!g){var E=e({direction:i?"in":"out"});u=wa(a,E,t,o,p)}}),{abort:()=>{g=!0,u?.abort()},deactivate:()=>u.deactivate(),reset:()=>u.reset(),t:()=>u.t()}}if(t?.deactivate(),!e?.duration)return p(),{abort:ea,deactivate:ea,reset:ea,t:()=>o};const{delay:_=0,css:h,tick:f,easing:m=Be}=e;var s=[];if(i&&t===void 0&&(f&&f(0,1),h)){var k=Pa(h(0,1));s.push(k,k)}var w=()=>1-o,l=a.animate(s,{duration:_,fill:"forwards"});return l.onfinish=()=>{l.cancel();var E=t?.t()??1-o;t?.abort();var K=o-E,$=e.duration*Math.abs(K),T=[];if($>0){var U=!1;if(h)for(var D=Math.ceil($/16.666666666666668),C=0;C<=D;C+=1){var W=E+K*m(C/D),A=Pa(h(W,1-W));T.push(A),U||=A.overflow==="hidden"}U&&(a.style.overflow="hidden"),w=()=>{var N=l.currentTime;return E+K*m(N/$)},f&&Ee(()=>{if(l.playState!=="running")return!1;var N=w();return f(N,1-N),!0})}l=a.animate(T,{duration:$,fill:"forwards"}),l.onfinish=()=>{w=()=>o,f?.(o,1-o),p()}},{abort:()=>{l&&(l.cancel(),l.effect=null,l.onfinish=ea)},deactivate:()=>{p=ea},reset:()=>{o===0&&f?.(1,0)},t:()=>w()}}var ba;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.UPDATE_NOT_AVAILABLE=1]="UPDATE_NOT_AVAILABLE",a[a.UPDATE_AVAILABLE=2]="UPDATE_AVAILABLE",a[a.UPDATE_IN_PROGRESS=3]="UPDATE_IN_PROGRESS"})(ba||(ba={}));var G;(function(a){a[a.UNKNOWN=0]="UNKNOWN",a[a.PENDING=1]="PENDING",a[a.DOWNLOADING=2]="DOWNLOADING",a[a.INSTALLING=3]="INSTALLING",a[a.INSTALLED=4]="INSTALLED",a[a.FAILED=5]="FAILED",a[a.CANCELED=6]="CANCELED",a[a.DOWNLOADED=11]="DOWNLOADED"})(G||(G={}));var Ta;(function(a){a[a.OK=0]="OK",a[a.CANCELED=1]="CANCELED",a[a.FAILED=2]="FAILED",a[a.NOT_AVAILABLE=3]="NOT_AVAILABLE",a[a.NOT_ALLOWED=4]="NOT_ALLOWED",a[a.INFO_MISSING=5]="INFO_MISSING"})(Ta||(Ta={}));const ua=Ae("AppUpdate",{web:()=>Ne(()=>import("../chunks/BavVy2A9.js"),__vite__mapDeps([0,1]),import.meta.url).then(a=>new a.AppUpdateWeb)});async function Pe(){if(!ya.isNativePlatform())return console.log("[AppUpdate] Not a native platform, skipping update check"),{updateAvailable:!1};try{const a=await ua.getAppUpdateInfo();console.log("[AppUpdate] Update info:",{updateAvailability:a.updateAvailability,availableVersionName:a.availableVersionName,currentVersionName:a.currentVersionName,availableVersionCode:a.availableVersionCode,currentVersionCode:a.currentVersionCode});const e=a.updateAvailability===ba.UPDATE_AVAILABLE;return console.log("[AppUpdate] Update available:",e),{updateAvailable:e,currentVersion:a.currentVersionName,availableVersion:a.availableVersionName}}catch(a){return console.error("[AppUpdate] Failed to check for update:",a),{updateAvailable:!1}}}async function Te(){if(!ya.isNativePlatform())return console.log("[AppUpdate] Not native platform, skipping"),!1;try{console.log("[AppUpdate] Calling startFlexibleUpdate...");const a=await ua.startFlexibleUpdate();return console.log("[AppUpdate] startFlexibleUpdate response:",a),!0}catch(a){return console.error("[AppUpdate] Failed to start flexible update:",a),!1}}async function Ie(){if(ya.isNativePlatform())try{await ua.completeFlexibleUpdate()}catch(a){console.error("Failed to complete flexible update:",a)}}function Ue(a){return ua.addListener("onFlexibleUpdateStateChange",a)}var Ce=z('<span class="message svelte-1ck5qw8"> </span> <div class="actions svelte-1ck5qw8"><button class="dismiss svelte-1ck5qw8">나중에</button> <button class="update svelte-1ck5qw8">업데이트</button></div>',1),qe=z('<span class="message svelte-1ck5qw8"> </span> <div class="progress-bar svelte-1ck5qw8"><div class="progress svelte-1ck5qw8"></div></div>',1),Ve=z('<span class="message svelte-1ck5qw8">업데이트 준비 완료</span> <div class="actions svelte-1ck5qw8"><button class="dismiss svelte-1ck5qw8">나중에</button> <button class="update svelte-1ck5qw8">지금 설치</button></div>',1),xe=z('<span class="message svelte-1ck5qw8">설치 중...</span>'),Me=z('<div><div class="content svelte-1ck5qw8"><!></div></div>');function $e(a,e){Aa(e,!1);let t=J("idle"),o=J(0),p=J(""),i=null;async function u(){i||(console.log("[AppUpdateBanner] Setting up update listener..."),i=await Ue(s=>{switch(console.log("[AppUpdateBanner] Update state change:",s),s.status){case G.PENDING:console.log("[AppUpdateBanner] Update pending"),v(t,"downloading"),v(o,0);break;case G.DOWNLOADING:v(t,"downloading"),s.bytesDownloaded!==void 0&&s.totalBytesToDownload!==void 0&&s.totalBytesToDownload>0&&(v(o,Math.round(s.bytesDownloaded/s.totalBytesToDownload*100)),console.log("[AppUpdateBanner] Download progress:",r(o)+"%",`(${s.bytesDownloaded}/${s.totalBytesToDownload})`));break;case G.DOWNLOADED:v(t,"downloaded"),v(o,100),console.log("[AppUpdateBanner] Download complete");break;case G.INSTALLING:v(t,"installing"),console.log("[AppUpdateBanner] Installing...");break;case G.INSTALLED:console.log("[AppUpdateBanner] Installed successfully"),v(t,"idle");break;case G.FAILED:console.error("[AppUpdateBanner] Update failed"),v(t,"available"),v(o,0);break;case G.CANCELED:console.log("[AppUpdateBanner] Update canceled"),v(t,"available"),v(o,0);break;default:console.log("[AppUpdateBanner] Unknown status:",s.status)}}),console.log("[AppUpdateBanner] Listener registered"))}Ua(async()=>{console.log("[AppUpdateBanner] Checking for updates...");const s=await Pe();console.log("[AppUpdateBanner] Update check result:",s),s.updateAvailable&&(v(t,"available"),v(p,s.availableVersion||""),console.log("[AppUpdateBanner] Update available, showing banner"))}),ee(()=>{i&&(i.remove(),i=null)});async function g(){if(r(t)==="available"){await u(),console.log("[AppUpdateBanner] Starting flexible update..."),v(t,"downloading"),v(o,0);const s=await Te();console.log("[AppUpdateBanner] startFlexibleUpdate result:",s),s||(console.error("[AppUpdateBanner] Failed to start update"),v(t,"available"))}else r(t)==="downloaded"&&(console.log("[AppUpdateBanner] Completing update..."),v(t,"installing"),await Ie())}function _(){v(t,"idle")}La();var h=x(),f=L(h);{var m=s=>{var k=Me();let w;var l=O(k),E=O(l);{var K=T=>{var U=Ce(),D=L(U),C=O(D);y(D);var W=M(D,2),A=O(W),N=M(A,2);y(W),ra(()=>ma(C,`새 버전이 있습니다${r(p)?` (${r(p)})`:""}`)),ta("click",A,_),ta("click",N,g),c(T,U)},$=T=>{var U=x(),D=L(U);{var C=A=>{var N=qe(),d=L(N),B=O(d);y(d);var I=M(d,2),n=O(I);y(I),ra(()=>{ma(B,`다운로드 중... ${r(o)??""}%`),ke(n,`width: ${r(o)??""}%`)}),c(A,N)},W=A=>{var N=x(),d=L(N);{var B=n=>{var b=Ve(),q=M(L(b),2),H=O(q),Y=M(H,2);y(q),ta("click",H,_),ta("click",Y,g),c(n,b)},I=n=>{var b=x(),q=L(b);{var H=Y=>{var ha=xe();c(Y,ha)};P(q,Y=>{r(t)==="installing"&&Y(H)},!0)}c(n,b)};P(d,n=>{r(t)==="downloaded"?n(B):n(I,!1)},!0)}c(A,N)};P(D,A=>{r(t)==="downloading"?A(C):A(W,!1)},!0)}c(T,U)};P(E,T=>{r(t)==="available"?T(K):T($,!1)})}y(l),y(k),ra(()=>w=_a(k,1,"update-banner svelte-1ck5qw8",null,w,{downloading:r(t)==="downloading"})),c(s,k)};P(f,s=>{r(t)!=="idle"&&s(m)})}c(a,h),Na()}function We(){const{subscribe:a,set:e}=Ca(navigator.onLine);return window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)),{subscribe:a}}const Fe=We();function Ge(){const{subscribe:a,set:e,update:t}=Ca({dismissed:!1,lastDismissed:0});return{subscribe:a,dismiss:()=>{t(o=>({...o,dismissed:!0,lastDismissed:Date.now()}))},reset:()=>{t(o=>({...o,dismissed:!1}))}}}const ka=Ge(),Se=te([Fe,ka],([a,e])=>(a&&e.dismissed&&setTimeout(()=>ka.reset(),1e4),!a&&!e.dismissed));function ze(a){const e=a-1;return e*e*e+1}function Ia(a){const e=typeof a=="string"&&a.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[a,"px"]}function Ke(a,{delay:e=0,duration:t=400,easing:o=ze,x:p=0,y:i=0,opacity:u=0}={}){const g=getComputedStyle(a),_=+g.opacity,h=g.transform==="none"?"":g.transform,f=_*(1-u),[m,s]=Ia(p),[k,w]=Ia(i);return{delay:e,duration:t,easing:o,css:(l,E)=>`
			transform: ${h} translate(${(1-l)*m}${s}, ${(1-l)*k}${w});
			opacity: ${_-f*E}`}}var He=z('<div class="offline-banner svelte-l46k7l" role="alert"><div class="banner-content svelte-l46k7l"><svg viewBox="0 0 24 24" fill="none" class="banner-icon svelte-l46k7l" width="20" height="20"><path d="M1 1l22 22M9 9a6 6 0 008.5 8.5M5.64 5.64A10 10 0 0019 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><circle cx="12" cy="18" r="1" fill="currentColor"></circle></svg> <span class="banner-text svelte-l46k7l">오프라인 상태입니다</span></div> <button class="dismiss-btn svelte-l46k7l" aria-label="닫기"><svg viewBox="0 0 24 24" fill="none" width="18" height="18"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg></button></div>');function je(a,e){Aa(e,!1);const t=()=>pa(Se,"$showOfflineBanner",o),[o,p]=Va();function i(){ka.dismiss()}La();var u=x(),g=L(u);{var _=h=>{var f=He(),m=M(O(f),2);y(f),ta("click",m,i),Oe(3,f,()=>Ke,()=>({y:-50,duration:300})),c(h,f)};P(g,h=>{t()&&h(_)})}c(a,u),Na(),p()}var Ye=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M3 9.5L12 3l9 6.5V20a1 1 0 01-1 1h-5v-6a1 1 0 00-1-1h-4a1 1 0 00-1 1v6H4a1 1 0 01-1-1V9.5z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path></svg>'),Je=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.8"></rect><path d="M8 8h8M8 12h8M8 16h5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path></svg>'),Qe=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M3 17l6-6 4 4 8-8" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17 7h4v4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path></svg>'),Re=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-4-7 4V5z" stroke="currentColor" stroke-width="1.8" stroke-linejoin="round"></path></svg>'),Xe=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="1.8"></circle><path d="M4 20c0-4 4-6 8-6s8 2 8 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path></svg>'),Ze=aa('<svg viewBox="0 0 24 24" fill="none" class="svelte-12qhfyh"><path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="currentColor" stroke-width="1.8"></path><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 112.83-2.83l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 114 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 112.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="1.8"></path></svg>'),at=z('<a><div class="tab-icon svelte-12qhfyh"><!></div> <span class="tab-label svelte-12qhfyh"> </span></a>'),et=z('<nav class="tab-bar svelte-12qhfyh"></nav>'),tt=z('<!> <!> <div class="app svelte-12qhfyh"><main><!></main> <!></div>',1);function Nt(a,e){Aa(e,!1);const t=()=>pa(Ba,"$isLoggedIn",i),o=()=>pa(me,"$page",i),p=()=>pa(_e,"$isAdmin",i),[i,u]=Va(),g=J(),_=J(),h=J(),f=["/login","/signup","/privacy","/terms","/forgot-password","/find-username"];let m=J(!1),s=!1;const k={home:"/",feed:"/today",trending:"/trending"};Ua(async()=>{const d=()=>{fa.clear(),da(`${V}/login`)};window.addEventListener("auth:expired",d),fa.init(),v(m,!0);const B=window.location.pathname.replace(V,"")||"/",I=f.some(n=>B.startsWith(n));if(Da(Ba)){if(!await fa.refresh()&&!I)return fa.clear(),da(`${V}/login`),()=>window.removeEventListener("auth:expired",d);if(await Oa.init(),B==="/"&&!s){const b=Da(we),q=k[b]||"/";q!=="/"&&(s=!0,da(`${V}${q}`,{replaceState:!0}))}be.init()}else await Oa.init();return()=>window.removeEventListener("auth:expired",d)});function w(d,B){if(!r(m))return;const I=B.replace(V,"")||"/",n=f.some(b=>I.startsWith(b));!d&&!n&&da(`${V}/login`)}function l(d){return d==="/"?r(g)==="/"||r(g)===V+"/":r(g).includes(d)}const E=[{path:"/",label:"홈",icon:"home",show:"always"},{path:"/today",label:"피드",icon:"feed",show:"always"},{path:"/trending",label:"트렌드",icon:"trend",show:"always"},{path:"/bookmarks",label:"저장",icon:"bookmark",show:"logged-in"},{path:"/mypage",label:"MY",icon:"user",show:"logged-in"},{path:"/admin",label:"관리",icon:"admin",show:"admin"}];ca(()=>(r(m),t(),o()),()=>{r(m)&&w(t(),o().url.pathname)}),ca(()=>o(),()=>{v(g,o().url.pathname)}),ca(()=>(r(g),V),()=>{v(_,f.some(d=>(r(g).replace(V,"")||"/").startsWith(d)))}),ca(()=>(t(),p()),()=>{v(h,E.filter(d=>d.show==="always"?!0:d.show==="logged-in"?t():d.show==="admin"?p():!1))}),pe(),La();var K=tt(),$=L(K);$e($,{});var T=M($,2);je(T,{});var U=M(T,2),D=O(U);let C;var W=O(D);Le(W,e,"default",{}),y(D);var A=M(D,2);{var N=d=>{var B=et();he(B,5,()=>r(h),I=>I.path,(I,n)=>{var b=at();let q;var H=O(b),Y=O(H);{var ha=j=>{var oa=Ye();c(j,oa)},Ma=j=>{var oa=x(),Wa=L(oa);{var Fa=Q=>{var sa=Je();c(Q,sa)},Ga=Q=>{var sa=x(),Sa=L(sa);{var za=R=>{var na=Qe();c(R,na)},Ka=R=>{var na=x(),Ha=L(na);{var ja=X=>{var ia=Re();c(X,ia)},Ya=X=>{var ia=x(),Ja=L(ia);{var Qa=Z=>{var la=Xe();c(Z,la)},Ra=Z=>{var la=x(),Xa=L(la);{var Za=ga=>{var ae=Ze();c(ga,ae)};P(Xa,ga=>{r(n),F(()=>r(n).icon==="admin")&&ga(Za)},!0)}c(Z,la)};P(Ja,Z=>{r(n),F(()=>r(n).icon==="user")?Z(Qa):Z(Ra,!1)},!0)}c(X,ia)};P(Ha,X=>{r(n),F(()=>r(n).icon==="bookmark")?X(ja):X(Ya,!1)},!0)}c(R,na)};P(Sa,R=>{r(n),F(()=>r(n).icon==="trend")?R(za):R(Ka,!1)},!0)}c(Q,sa)};P(Wa,Q=>{r(n),F(()=>r(n).icon==="feed")?Q(Fa):Q(Ga,!1)},!0)}c(j,oa)};P(Y,j=>{r(n),F(()=>r(n).icon==="home")?j(ha):j(Ma,!1)})}y(H);var Ea=M(H,2),$a=O(Ea,!0);y(Ea),y(b),ra(j=>{q=_a(b,1,"tab-item svelte-12qhfyh",null,q,j),ge(b,"href",`${V??""}${r(n),F(()=>r(n).path==="/"?"/":r(n).path)??""}`),ma($a,(r(n),F(()=>r(n).label)))},[()=>({active:l(r(n).path)})]),c(I,b)}),y(B),c(d,B)};P(A,d=>{r(_)||d(N)})}y(U),ra(()=>C=_a(D,1,"main svelte-12qhfyh",null,C,{"no-tabbar":r(_)})),c(a,K),Na(),u()}export{Nt as component};
