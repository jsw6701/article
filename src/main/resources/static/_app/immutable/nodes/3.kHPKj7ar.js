import{f as y,a as u,c as Ce}from"../chunks/TFX7ugsA.js";import"../chunks/D6SK0GIy.js";import{o as Oe}from"../chunks/DujhYGdh.js";import{p as Qe,t as $,a as Te,o as g,Y as A,c as s,s as t,b as e,g as a,f as ie}from"../chunks/C9SIyTFa.js";import{i as B,s as n,e as Xe}from"../chunks/bwNj2O70.js";import{e as I,i as P}from"../chunks/DShnAKY6.js";import{s as De}from"../chunks/xoXkTC80.js";import{s as Ze}from"../chunks/lJrTxOp0.js";import{s as R}from"../chunks/6RZwXm1a.js";import{i as es}from"../chunks/CSrNcNRV.js";import{b as le}from"../chunks/DvH0yMmo.js";import{g as ss}from"../chunks/De4q2J6q.js";import{e as as,f as ts,h as vs,i as rs,j as is,k as ls}from"../chunks/95k2wcHO.js";import{i as ds,a as ns}from"../chunks/EHLbj6ui.js";var cs=y('<div class="loading svelte-1jef3w8"><div class="spinner svelte-1jef3w8"></div></div>'),os=y('<div class="error svelte-1jef3w8"><p> </p> <button class="svelte-1jef3w8">다시 시도</button></div>'),fs=y('<div class="bar-item svelte-1jef3w8"><div class="bar-wrapper svelte-1jef3w8"><div class="bar svelte-1jef3w8"></div></div> <span class="bar-label svelte-1jef3w8"> </span> <span class="bar-value svelte-1jef3w8"> </span></div>'),ps=y('<div class="bar-item svelte-1jef3w8"><div class="bar-wrapper svelte-1jef3w8"><div class="bar bar-view svelte-1jef3w8"></div></div> <span class="bar-label svelte-1jef3w8"> </span> <span class="bar-value svelte-1jef3w8"> </span></div>'),ms=y('<div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">성별 분포</h3> <div class="dist-items svelte-1jef3w8"><div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8">남성</span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar male svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div> <div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8">여성</span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar female svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div></div></div>'),ws=y('<div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8"> </span> <div class="dist-bar-wrapper svelte-1jef3w8"><div class="dist-bar age svelte-1jef3w8"></div></div> <span class="dist-value svelte-1jef3w8"> </span></div>'),us=y('<div class="dist-item svelte-1jef3w8"><span class="dist-label svelte-1jef3w8"> </span> <div class="dist-bar-wrapper svelte-1jef3w8"><div></div></div> <span class="dist-value svelte-1jef3w8"> </span></div>'),_s=y('<section class="summary-section svelte-1jef3w8"><div class="summary-grid svelte-1jef3w8"><div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 사용자</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div> <div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 조회수</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div> <div class="summary-card svelte-1jef3w8"><span class="summary-label svelte-1jef3w8">전체 카드</span> <span class="summary-value svelte-1jef3w8"> </span> <span class="summary-sub svelte-1jef3w8"> </span></div></div></section> <section class="chart-section svelte-1jef3w8"><div class="section-header svelte-1jef3w8"><h2 class="svelte-1jef3w8">일별 가입자 추이</h2> <span class="period svelte-1jef3w8"></span></div> <div class="bar-chart svelte-1jef3w8"></div></section> <section class="chart-section svelte-1jef3w8"><div class="section-header svelte-1jef3w8"><h2 class="svelte-1jef3w8">일별 조회수 추이</h2> <span class="period svelte-1jef3w8"></span></div> <div class="bar-chart svelte-1jef3w8"></div></section> <section class="distribution-section svelte-1jef3w8"><div class="dist-row svelte-1jef3w8"><!> <div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">연령대 분포</h3> <div class="dist-items svelte-1jef3w8"></div></div> <div class="dist-card svelte-1jef3w8"><h3 class="svelte-1jef3w8">회원 등급 분포</h3> <div class="dist-items svelte-1jef3w8"></div></div></div></section>',1),js=y('<div class="admin-page svelte-1jef3w8"><header class="page-header svelte-1jef3w8"><h1 class="svelte-1jef3w8">관리자 대시보드</h1> <nav class="admin-nav svelte-1jef3w8"><a class="nav-item active svelte-1jef3w8">대시보드</a> <a class="nav-item svelte-1jef3w8">유저 관리</a></nav></header> <!></div>');function Ls(Re,Ge){Qe(Ge,!1);let x=A(null),W=A([]),Y=A([]),_=A(null),q=A([]),z=A([]),E=A(!0),N=A(null),de=30;Oe(()=>{const r=ds.subscribe(async c=>{if(c){const G=ns.subscribe(async M=>{if(!M){ss(`${le}/`);return}await ne(),G()});r()}});return r});async function ne(){g(E,!0),g(N,null);try{const[r,c,G,M,J,S]=await Promise.all([as(),ts(de),vs(de),rs(),is(),ls()]);g(x,r),g(W,c),g(Y,G),g(_,M),g(q,J),g(z,S)}catch(r){g(N,r?.message??"데이터를 불러오는데 실패했습니다")}finally{g(E,!1)}}function j(r){return r.toLocaleString()}function C(r,c){return c===0?0:r/c*100}function V(r){return Math.max(...r.map(c=>c.count),1)}function ce(r){const c=new Date(r);return`${c.getMonth()+1}/${c.getDate()}`}es();var F=js(),H=s(F),oe=t(s(H),2),fe=s(oe),Me=t(fe,2);e(oe),e(H);var ke=t(H,2);{var Le=r=>{var c=cs();u(r,c)},Ne=r=>{var c=Ce(),G=ie(c);{var M=S=>{var D=os(),k=s(D),K=s(k,!0);e(k);var L=t(k,2);e(D),$(()=>n(K,a(N))),Xe("click",L,ne),u(S,D)},J=S=>{var D=Ce(),k=ie(D);{var K=L=>{var pe=_s(),O=ie(pe),me=s(O),Q=s(me),T=t(s(Q),2),Ve=s(T,!0);e(T);var we=t(T,2),Ue=s(we);e(we),e(Q);var X=t(Q,2),Z=t(s(X),2),Be=s(Z,!0);e(Z);var ue=t(Z,2),Ie=s(ue);e(ue),e(X);var _e=t(X,2),ee=t(s(_e),2),Pe=s(ee,!0);e(ee);var je=t(ee,2),We=s(je);e(je),e(_e),e(me),e(O);var se=t(O,2),ae=s(se),Ye=t(s(ae),2);Ye.textContent="최근 30일",e(ae);var be=t(ae,2);I(be,5,()=>a(W).slice(-14),P,(o,v)=>{var l=fs(),i=s(l),f=s(i);e(i);var d=t(i,2),m=s(d,!0);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{R(f,`height: ${w??""}%`),n(m,h),n(b,a(v).count)},[()=>C(a(v).count,V(a(W))),()=>ce(a(v).date)]),u(o,l)}),e(be),e(se);var te=t(se,2),ve=s(te),qe=t(s(ve),2);qe.textContent="최근 30일",e(ve);var ge=t(ve,2);I(ge,5,()=>a(Y).slice(-14),P,(o,v)=>{var l=ps(),i=s(l),f=s(i);e(i);var d=t(i,2),m=s(d,!0);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{R(f,`height: ${w??""}%`),n(m,h),n(b,a(v).count)},[()=>C(a(v).count,V(a(Y))),()=>ce(a(v).date)]),u(o,l)}),e(ge),e(te);var he=t(te,2),ye=s(he),xe=s(ye);{var ze=o=>{var v=ms(),l=t(s(v),2),i=s(l),f=t(s(i),2),d=s(f);e(f);var m=t(f,2),p=s(m,!0);e(m),e(i);var b=t(i,2),w=t(s(b),2),h=s(w);e(w);var U=t(w,2),Ee=s(U,!0);e(U),e(b),e(l),e(v),$((Fe,He,Je,Ke)=>{R(d,`width: ${Fe??""}%`),n(p,He),R(h,`width: ${Je??""}%`),n(Ee,Ke)},[()=>C(a(_).male,a(_).male+a(_).female),()=>j(a(_).male),()=>C(a(_).female,a(_).male+a(_).female),()=>j(a(_).female)]),u(o,v)};B(xe,o=>{a(_)&&o(ze)})}var re=t(xe,2),Se=t(s(re),2);I(Se,5,()=>a(q),P,(o,v)=>{var l=ws(),i=s(l),f=s(i,!0);e(i);var d=t(i,2),m=s(d);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h)=>{n(f,a(v).displayName),R(m,`width: ${w??""}%`),n(b,h)},[()=>C(a(v).count,V(a(q))),()=>j(a(v).count)]),u(o,l)}),e(Se),e(re);var $e=t(re,2),Ae=t(s($e),2);I(Ae,5,()=>a(z),P,(o,v)=>{var l=us(),i=s(l),f=s(i,!0);e(i);var d=t(i,2),m=s(d);e(d);var p=t(d,2),b=s(p,!0);e(p),e(l),$((w,h,U)=>{n(f,a(v).displayName),Ze(m,1,`dist-bar grade grade-${w??""}`,"svelte-1jef3w8"),R(m,`width: ${h??""}%`),n(b,U)},[()=>a(v).grade.toLowerCase(),()=>C(a(v).count,V(a(z))),()=>j(a(v).count)]),u(o,l)}),e(Ae),e($e),e(ye),e(he),$((o,v,l,i,f,d)=>{n(Ve,o),n(Ue,`오늘 +${v??""}`),n(Be,l),n(Ie,`오늘 +${i??""}`),n(Pe,f),n(We,`활성 ${d??""}`)},[()=>j(a(x).totalUsers),()=>j(a(x).todaySignups),()=>j(a(x).totalViews),()=>j(a(x).todayViews),()=>j(a(x).totalCards),()=>j(a(x).activeCards)]),u(L,pe)};B(k,L=>{a(x)&&L(K)},!0)}u(S,D)};B(G,S=>{a(N)?S(M):S(J,!1)},!0)}u(r,c)};B(ke,r=>{a(E)?r(Le):r(Ne,!1)})}e(F),$(()=>{De(fe,"href",`${le??""}/admin`),De(Me,"href",`${le??""}/admin/users`)}),u(Re,F),Te()}export{Ls as component};
